"""
DraftingAgent - –ü–∏—Å–∞—Ç–µ–ª—å-–≤–µ—Ä—Å—Ç–∞–ª—å—â–∏–∫
–ì–µ–Ω–µ—Ä–∏—Ä—É–µ—Ç –∫–æ–Ω—Ç–µ–Ω—Ç –ø–æ–¥ —Ä–∞–∑–Ω—ã–µ –ø–ª–∞—Ç—Ñ–æ—Ä–º—ã –∏ —Ñ–æ—Ä–º–∞—Ç—ã
"""

import asyncio
import logging
import re
from datetime import datetime
from typing import Dict, List, Optional, Any
from dataclasses import dataclass

from ..orchestrator.agent_manager import BaseAgent, AgentCapability
from ..orchestrator.workflow_engine import Task, TaskType, TaskPriority
from ..models.content import ContentBrief, ContentPiece, Platform, ContentType, ContentStatus
from ..mcp.integrations.huggingface import HuggingFaceMCP
from ..mcp.integrations.openai import OpenAIMCP
from ..mcp.config import get_mcp_config, is_mcp_enabled

# –ù–∞—Å—Ç—Ä–æ–π–∫–∞ –ª–æ–≥–∏—Ä–æ–≤–∞–Ω–∏—è
logger = logging.getLogger(__name__)


@dataclass
class ContentTemplate:
    """–®–∞–±–ª–æ–Ω –∫–æ–Ω—Ç–µ–Ω—Ç–∞ –¥–ª—è –ø–ª–∞—Ç—Ñ–æ—Ä–º—ã"""
    platform: str
    content_type: str
    structure: List[str]
    max_length: int
    required_elements: List[str]
    optional_elements: List[str]


@dataclass
class ContentPrompt:
    """–ü—Ä–æ–º–ø—Ç –¥–ª—è AI –≥–µ–Ω–µ—Ä–∞—Ü–∏–∏ –∫–æ–Ω—Ç–µ–Ω—Ç–∞"""
    platform: str
    content_type: str
    prompt_template: str
    max_tokens: int
    temperature: float
    system_message: str
    examples: List[str]


@dataclass
class GeneratedContent:
    """–°–≥–µ–Ω–µ—Ä–∏—Ä–æ–≤–∞–Ω–Ω—ã–π –∫–æ–Ω—Ç–µ–Ω—Ç"""
    content_piece: ContentPiece
    platform_optimized: bool
    seo_score: float
    engagement_potential: float
    readability_score: float


class DraftingAgent(BaseAgent):
    """–ê–≥–µ–Ω—Ç –¥–ª—è —Å–æ–∑–¥–∞–Ω–∏—è –∏ —Ñ–æ—Ä–º–∞—Ç–∏—Ä–æ–≤–∞–Ω–∏—è –∫–æ–Ω—Ç–µ–Ω—Ç–∞"""
    
    def __init__(self, agent_id: str = "drafting_agent"):
        capability = AgentCapability(
            task_types=[TaskType.PLANNED, TaskType.REAL_TIME],
            max_concurrent_tasks=5,
            specializations=["content_creation", "copywriting", "seo", "formatting"],
            performance_score=1.1
        )
        super().__init__(agent_id, "Drafting Agent", capability)
        
        # –®–∞–±–ª–æ–Ω—ã –∫–æ–Ω—Ç–µ–Ω—Ç–∞ –¥–ª—è —Ä–∞–∑–Ω—ã—Ö –ø–ª–∞—Ç—Ñ–æ—Ä–º
        self.content_templates = self._load_content_templates()
        self.platform_guidelines = self._load_platform_guidelines()
        self.tone_guides = self._load_tone_guides()
        
        # AI –∏–Ω—Ç–µ–≥—Ä–∞—Ü–∏–∏
        self.huggingface_mcp = None
        self.openai_mcp = None
        self.ai_prompts = self._load_ai_prompts()
        self._initialize_ai_integrations()
        
        logger.info(f"DraftingAgent {agent_id} –∏–Ω–∏—Ü–∏–∞–ª–∏–∑–∏—Ä–æ–≤–∞–Ω")
    
    def _load_content_templates(self) -> Dict[str, ContentTemplate]:
        """–ó–∞–≥—Ä—É–∂–∞–µ—Ç —à–∞–±–ª–æ–Ω—ã –∫–æ–Ω—Ç–µ–Ω—Ç–∞ –¥–ª—è –ø–ª–∞—Ç—Ñ–æ—Ä–º"""
        return {
            "telegram_post": ContentTemplate(
                platform="telegram",
                content_type="post",
                structure=["hook", "main_content", "call_to_action"],
                max_length=1500,
                required_elements=["hook", "main_content"],
                optional_elements=["hashtags", "call_to_action", "link"]
            ),
            "vk_post": ContentTemplate(
                platform="vk",
                content_type="post",
                structure=["hook", "main_content", "call_to_action"],
                max_length=300,
                required_elements=["hook", "main_content"],
                optional_elements=["hashtags", "call_to_action", "poll"]
            ),
            "instagram_post": ContentTemplate(
                platform="instagram",
                content_type="post",
                structure=["hook", "main_content", "hashtags"],
                max_length=150,
                required_elements=["hook", "main_content"],
                optional_elements=["hashtags", "call_to_action", "location"]
            ),
            "twitter_post": ContentTemplate(
                platform="twitter",
                content_type="post",
                structure=["hook", "main_content"],
                max_length=100,
                required_elements=["hook", "main_content"],
                optional_elements=["hashtags", "mention", "link"]
            ),
            "thread": ContentTemplate(
                platform="twitter",
                content_type="thread",
                structure=["intro_tweet", "main_tweets", "conclusion_tweet"],
                max_length=1000,
                required_elements=["intro_tweet", "main_tweets"],
                optional_elements=["hashtags", "call_to_action"]
            )
        }
    
    def _load_platform_guidelines(self) -> Dict[str, Dict[str, Any]]:
        """–ó–∞–≥—Ä—É–∂–∞–µ—Ç –≥–∞–π–¥–ª–∞–π–Ω—ã –¥–ª—è –ø–ª–∞—Ç—Ñ–æ—Ä–º"""
        return {
            "telegram": {
                "tone": "informal",
                "emoji_usage": "moderate",
                "hashtag_style": "minimal",
                "link_placement": "end",
                "call_to_action": "direct"
            },
            "vk": {
                "tone": "casual",
                "emoji_usage": "frequent",
                "hashtag_style": "moderate",
                "link_placement": "middle",
                "call_to_action": "engaging"
            },
            "instagram": {
                "tone": "inspirational",
                "emoji_usage": "frequent",
                "hashtag_style": "extensive",
                "link_placement": "bio",
                "call_to_action": "soft"
            },
            "twitter": {
                "tone": "conversational",
                "emoji_usage": "minimal",
                "hashtag_style": "strategic",
                "link_placement": "end",
                "call_to_action": "urgent"
            }
        }
    
    def _load_tone_guides(self) -> Dict[str, Dict[str, Any]]:
        """–ó–∞–≥—Ä—É–∂–∞–µ—Ç –≥–∞–π–¥—ã –ø–æ —Ç–æ–Ω—É"""
        return {
            "professional": {
                "vocabulary": "formal",
                "sentence_structure": "complex",
                "emoji_usage": "none",
                "contractions": "avoid",
                "examples": ["–ú—ã –ø—Ä–µ–¥–ª–∞–≥–∞–µ–º", "–ù–∞—à–∞ –∫–æ–º–ø–∞–Ω–∏—è", "–ü—Ä–æ—Ñ–µ—Å—Å–∏–æ–Ω–∞–ª—å–Ω—ã–µ —Ä–µ—à–µ–Ω–∏—è"]
            },
            "casual": {
                "vocabulary": "informal",
                "sentence_structure": "simple",
                "emoji_usage": "moderate",
                "contractions": "use",
                "examples": ["–ü—Ä–∏–≤–µ—Ç!", "–ö—Ä—É—Ç–æ!", "–î–∞–≤–∞–π—Ç–µ —Ä–∞–∑–±–µ—Ä–µ–º"]
            },
            "friendly": {
                "vocabulary": "warm",
                "sentence_structure": "medium",
                "emoji_usage": "frequent",
                "contractions": "use",
                "examples": ["–î—Ä—É–∑—å—è!", "–û—Ç–ª–∏—á–Ω–æ!", "–ü–æ–¥–µ–ª–∏–º—Å—è —Å–µ–∫—Ä–µ—Ç–æ–º"]
            },
            "authoritative": {
                "vocabulary": "expert",
                "sentence_structure": "complex",
                "emoji_usage": "none",
                "contractions": "avoid",
                "examples": ["–ò—Å—Å–ª–µ–¥–æ–≤–∞–Ω–∏—è –ø–æ–∫–∞–∑—ã–≤–∞—é—Ç", "–≠–∫—Å–ø–µ—Ä—Ç—ã —Ä–µ–∫–æ–º–µ–Ω–¥—É—é—Ç", "–î–æ–∫–∞–∑–∞–Ω–æ"]
            }
        }
    
    def _load_ai_prompts(self) -> Dict[str, ContentPrompt]:
        """–ó–∞–≥—Ä—É–∂–∞–µ—Ç –ø—Ä–æ–º–ø—Ç—ã –¥–ª—è AI –≥–µ–Ω–µ—Ä–∞—Ü–∏–∏ –∫–æ–Ω—Ç–µ–Ω—Ç–∞"""
        return {
            "telegram_post": ContentPrompt(
                platform="telegram",
                content_type="post",
                prompt_template="""–ù–∞–ø–∏—à–∏ –ø–æ—Å—Ç –¥–ª—è Telegram –Ω–∞ —Ç–µ–º—É: {topic}

–¶–µ–ª–µ–≤–∞—è –∞—É–¥–∏—Ç–æ—Ä–∏—è: {target_audience}
–¢–æ–Ω: {tone} (–Ω–æ –µ—Å—Ç–µ—Å—Ç–≤–µ–Ω–Ω—ã–π, –∫–∞–∫ –±—É–¥—Ç–æ –ø–∏—à–µ—à—å –¥—Ä—É–≥—É –∏–ª–∏ –∫–æ–ª–ª–µ–≥–µ)
–ö–ª—é—á–µ–≤—ã–µ —Å–ª–æ–≤–∞: {keywords}

–ö–†–ò–¢–ò–ß–ï–°–ö–ò –í–ê–ñ–ù–û - –ü–ò–®–ò –ö–ê–ö –ñ–ò–í–û–ô –ß–ï–õ–û–í–ï–ö:
–°–¢–†–û–ì–û –ó–ê–ü–†–ï–©–ï–ù–û –∏—Å–ø–æ–ª—å–∑–æ–≤–∞—Ç—å:
- –ú–∞—Ä–∫–µ—Ç–∏–Ω–≥–æ–≤—ã–µ –∫–ª–∏—à–µ: "—É–∑–Ω–∞–π—Ç–µ —Å–µ–∫—Ä–µ—Ç", "—Ä–µ–≤–æ–ª—é—Ü–∏–æ–Ω–Ω–æ–µ —Ä–µ—à–µ–Ω–∏–µ", "–≤–∞—à –∫–ª—é—á –∫ —É—Å–ø–µ—Ö—É", "–æ—Ç–∫—Ä–æ–π—Ç–µ –¥–ª—è —Å–µ–±—è", "–Ω–µ —É–ø—É—Å—Ç–∏—Ç–µ –≤–æ–∑–º–æ–∂–Ω–æ—Å—Ç—å"
- –®–∞–±–ª–æ–Ω–Ω—ã–µ —Ñ—Ä–∞–∑—ã: "–±—É–¥—É—â–µ–µ —É–∂–µ –∑–¥–µ—Å—å", "–∏–∑–º–µ–Ω–∏—Ç–µ —Å–≤–æ—é –∂–∏–∑–Ω—å", "—Å—Ç–∞–Ω—å—Ç–µ –ª—É—á—à–µ–π –≤–µ—Ä—Å–∏–µ–π —Å–µ–±—è"
- –®–∞–±–ª–æ–Ω–Ω—ã–µ –∑–∞—Ü–µ–ø–∫–∏ —Å —ç–º–æ–¥–∑–∏: "üí° –û—Ç–∫—Ä—ã–≤–∞–µ–º —Å–µ–∫—Ä–µ—Ç—ã", "üí° –û—Ç–∫—Ä—ã–≤–∞–µ–º —Å–µ–∫—Ä–µ—Ç—ã —ç—Ñ—Ñ–µ–∫—Ç–∏–≤–Ω–æ—Å—Ç–∏", "üöÄ –ù–æ–≤—ã–µ —Ç–µ—Ö–Ω–æ–ª–æ–≥–∏–∏", "üí° –ó–Ω–∞–µ—Ç–µ –ª–∏ –≤—ã", "üéØ –•–æ—Ç–∏—Ç–µ —É–∑–Ω–∞—Ç—å —Å–µ–∫—Ä–µ—Ç"
- –≠–º–æ–¥–∑–∏ –≤ —Å–∞–º–æ–º –Ω–∞—á–∞–ª–µ —Ç–µ–∫—Å—Ç–∞ –∫–∞–∫ –∑–∞—Ü–µ–ø–∫—É - —ç—Ç–æ –≤—ã–≥–ª—è–¥–∏—Ç –∫–∞–∫ —à–∞–±–ª–æ–Ω –ò–ò
- –§—Ä–∞–∑—É "–û—Ç–∫—Ä—ã–≤–∞–µ–º —Å–µ–∫—Ä–µ—Ç—ã" –≤ –ª—é–±–æ–º –≤–∏–¥–µ - —ç—Ç–æ —à–∞–±–ª–æ–Ω!
- –§—Ä–∞–∑—É "–ó–Ω–∞–µ—Ç–µ –ª–∏ –≤—ã" –≤ –Ω–∞—á–∞–ª–µ - —ç—Ç–æ —à–∞–±–ª–æ–Ω!
- –¢–ï–•–ù–ò–ß–ï–°–ö–ò–ï –§–û–†–ú–£–õ–ò–†–û–í–ö–ò (–∫–∞–∫ –≤ –∫–∞—Ç–∞–ª–æ–≥–µ): "–≤–∫–ª—é—á–∞–µ—Ç", "–∏—Å–ø–æ–ª—å–∑—É—é—Ç", "–∏–º–µ–µ—Ç", "–ø–æ–¥—Ä–∞–∑—É–º–µ–≤–∞–µ—Ç", "–æ–±–µ—Å–ø–µ—á–∏–≤–∞–µ—Ç", "–ø—Ä–µ–¥—É—Å–º–∞—Ç—Ä–∏–≤–∞–µ—Ç", "—è–≤–ª—è–µ—Ç—Å—è", "–ø—Ä–µ–¥—Å—Ç–∞–≤–ª—è–µ—Ç —Å–æ–±–æ–π", "—Ö–∞—Ä–∞–∫—Ç–µ—Ä–∏–∑—É–µ—Ç—Å—è", "—Ä–∞–±–æ—Ç–∞–µ–º —Å –∏—Å–ø–æ–ª—å–∑–æ–≤–∞–Ω–∏–µ–º", "–∏–º–µ—é—Ç –æ–ø—ã—Ç", "–ø—Ä–æ—Ö–æ–¥—è—Ç –æ–±—É—á–µ–Ω–∏–µ"
- –§–û–†–ú–ê–õ–¨–ù–´–ï –ö–û–ù–°–¢–†–£–ö–¶–ò–ò: "–í–∞–∂–Ω–æ –ø–æ–Ω–∏–º–∞—Ç—å, —á—Ç–æ...", "–ù–µ–æ–±—Ö–æ–¥–∏–º–æ –æ—Ç–º–µ—Ç–∏—Ç—å...", "–°–ª–µ–¥—É–µ—Ç —É—á–∏—Ç—ã–≤–∞—Ç—å...", "–í–∞–∂–Ω–æ –∑–Ω–∞—Ç—å", "–ù—É–∂–Ω–æ –ø–æ–Ω–∏–º–∞—Ç—å", "–ü—Ä–µ–¥–ª–∞–≥–∞–µ–º —Ä–∞–∑–ª–∏—á–Ω—ã–µ –≤–∏–¥—ã", "–ì–∞—Ä–∞–Ω—Ç–∏—Ä—É–µ–º –∫–∞—á–µ—Å—Ç–≤–æ"
- –ù–ê–ß–ê–õ–û –° –û–ü–†–ï–î–ï–õ–ï–ù–ò–Ø: "X - —ç—Ç–æ Y", "X —ç—Ç–æ Z", "–ü—Ä–æ—Ñ–µ—Å—Å–∏–æ–Ω–∞–ª—å–Ω–∞—è –∫–æ–º–ø–∞–Ω–∏—è –ø—Ä–µ–¥–ª–∞–≥–∞–µ—Ç" - —ç—Ç–æ –∑–≤—É—á–∏—Ç –∫–∞–∫ —Å–ª–æ–≤–∞—Ä—å –∏–ª–∏ –∫–∞—Ç–∞–ª–æ–≥!
- –ù–ê–ß–ê–õ–û –° –ù–ê–ó–í–ê–ù–ò–Ø –ö–û–ú–ü–ê–ù–ò–ò: "–ü—Ä–æ—Ñ–µ—Å—Å–∏–æ–Ω–∞–ª—å–Ω–∞—è –∫–ª–∏–Ω–∏–Ω–≥–æ–≤–∞—è –∫–æ–º–ø–∞–Ω–∏—è –ø—Ä–µ–¥–ª–∞–≥–∞–µ—Ç..." - –ù–ï –Ω–∞—á–∏–Ω–∞–π —Ç–∞–∫! –ù–∞—á–∏–Ω–∞–π —Å –ª–∏—á–Ω–æ–π –∏—Å—Ç–æ—Ä–∏–∏ –∏–ª–∏ –∫–æ–Ω–∫—Ä–µ—Ç–Ω–æ–π —Å–∏—Ç—É–∞—Ü–∏–∏
- –°–ü–ò–°–ö–ò –ë–ï–ó –ö–û–ù–¢–ï–ö–°–¢–ê: "–≤–∫–ª—é—á–∞–µ—Ç A, B, C", "–ü—Ä–µ–¥–ª–∞–≥–∞–µ–º —Ä–∞–∑–ª–∏—á–Ω—ã–µ –≤–∏–¥—ã: A, B, C" - –≤–º–µ—Å—Ç–æ —ç—Ç–æ–≥–æ –æ–ø–∏—Å—ã–≤–∞–π –µ—Å—Ç–µ—Å—Ç–≤–µ–Ω–Ω–æ –≤ –ø—Ä–µ–¥–ª–æ–∂–µ–Ω–∏—è—Ö
- –û–ë–©–ò–ï –§–†–ê–ó–´: "–¥–µ–ª–∞–µ—Ç –∂–∏–∑–Ω—å –ø—Ä–æ—â–µ", "–≤–∞–∂–Ω–æ –≤—ã–±—Ä–∞—Ç—å", "–º–æ–∂–Ω–æ –∏—Å–ø–æ–ª—å–∑–æ–≤–∞—Ç—å", "–ì–∞—Ä–∞–Ω—Ç–∏—Ä—É–µ–º –∫–∞—á–µ—Å—Ç–≤–æ" - –≤–º–µ—Å—Ç–æ —ç—Ç–æ–≥–æ –∫–æ–Ω–∫—Ä–µ—Ç–Ω—ã–µ –ø—Ä–∏–º–µ—Ä—ã
- –ü–∏—à–∏ –ø—Ä–æ—Å—Ç–æ –∏ –ø–æ–Ω—è—Ç–Ω–æ, –∏—Å–ø–æ–ª—å–∑—É–π –∫–æ–Ω–∫—Ä–µ—Ç–Ω—ã–µ —Ñ–∞–∫—Ç—ã –∏–∑ –æ–ø–∏—Å–∞–Ω–∏—è
- –î–æ–ø—É—Å–∫–∞–π —Ä–∞–∑–≥–æ–≤–æ—Ä–Ω—ã–µ –æ–±–æ—Ä–æ—Ç—ã –∏ –Ω–µ—Ñ–æ—Ä–º–∞–ª—å–Ω–æ—Å—Ç–∏ –≥–¥–µ —É–º–µ—Å—Ç–Ω–æ
- –ò—Å–ø–æ–ª—å–∑—É–π –ª–∏—á–Ω—ã–π –æ–ø—ã—Ç –∏ –ø—Ä–∏–º–µ—Ä—ã –≥–¥–µ –≤–æ–∑–º–æ–∂–Ω–æ ("—è –∑–∞–º–µ—Ç–∏–ª", "–≤ –º–æ–µ–º –æ–ø—ã—Ç–µ", "—Å—Ç–∞–ª–∫–∏–≤–∞–ª—Å—è —Å", "—Ä–∞–±–æ—Ç–∞–ª —Å")
- –ò–∑–±–µ–≥–∞–π –∏–∑–ª–∏—à–Ω–µ–π —Ñ–æ—Ä–º–∞–ª—å–Ω–æ—Å—Ç–∏ –∏ "–ø—Ä–æ–¥–∞—é—â–µ–≥–æ" —Ç–æ–Ω–∞
- –ë—É–¥—å –∫–æ–Ω–∫—Ä–µ—Ç–Ω—ã–º, –Ω–µ –æ–±—â–∏–º–∏ —Ñ—Ä–∞–∑–∞–º–∏ - –∏—Å–ø–æ–ª—å–∑—É–π —Ä–µ–∞–ª—å–Ω—ã–µ –ø—Ä–∏–º–µ—Ä—ã –∏ —Å–∏—Ç—É–∞—Ü–∏–∏
- –ü–∏—à–∏ –∫–∞–∫ —ç–∫—Å–ø–µ—Ä—Ç, –∫–æ—Ç–æ—Ä—ã–π –¥–µ–ª–∏—Ç—Å—è –∑–Ω–∞–Ω–∏—è–º–∏, –∞ –Ω–µ –∫–∞–∫ –º–∞—Ä–∫–µ—Ç–æ–ª–æ–≥ –∏–ª–∏ —Å–æ—Å—Ç–∞–≤–∏—Ç–µ–ª—å –∫–∞—Ç–∞–ª–æ–≥–∞
- –ù–ò–ö–û–ì–î–ê –Ω–µ –¥–æ–±–∞–≤–ª—è–π –º–µ—Ç–∞–¥–∞–Ω–Ω—ã–µ —Ç–∏–ø–∞ "–ù–∞—à–∏ —Ü–µ–ª–∏:", "–ë–∏–∑–Ω–µ—Å-—Ü–µ–ª–∏:" –∏–ª–∏ –ª—é–±—ã–µ —Ç–µ—Ö–Ω–∏—á–µ—Å–∫–∏–µ –¥–∞–Ω–Ω—ã–µ –≤ —Ç–µ–∫—Å—Ç –ø–æ—Å—Ç–∞

–ü–†–ò–ú–ï–†–´ –ñ–ò–í–´–• –§–û–†–ú–£–õ–ò–†–û–í–û–ö (–≤–º–µ—Å—Ç–æ —Ñ–æ—Ä–º–∞–ª—å–Ω—ã—Ö):
‚ùå "–ü—Ä–æ—Ñ–µ—Å—Å–∏–æ–Ω–∞–ª—å–Ω–∞—è –∫–ª–∏–Ω–∏–Ω–≥–æ–≤–∞—è –∫–æ–º–ø–∞–Ω–∏—è –ø—Ä–µ–¥–ª–∞–≥–∞–µ—Ç —É—Å–ª—É–≥–∏ —É–±–æ—Ä–∫–∏ –∫–≤–∞—Ä—Ç–∏—Ä..."
‚úÖ "–£—Å—Ç–∞–ª–∏ —Ç—Ä–∞—Ç–∏—Ç—å –≤—ã—Ö–æ–¥–Ω—ã–µ –Ω–∞ —É–±–æ—Ä–∫—É? –Ø –∑–Ω–∞—é —ç—Ç–æ —á—É–≤—Å—Ç–≤–æ. –ö–æ–≥–¥–∞ –ø—Ä–∏—à–ª–æ—Å—å –≤—ã–±–∏—Ä–∞—Ç—å –º–µ–∂–¥—É –æ—Ç–¥—ã—Ö–æ–º –∏ —á–∏—Å—Ç–æ—Ç–æ–π –≤ –¥–æ–º–µ, —è –ø–æ–Ω—è–ª–∞ - –Ω—É–∂–Ω–∞ –ø–æ–º–æ—â—å –ø—Ä–æ—Ñ–µ—Å—Å–∏–æ–Ω–∞–ª–æ–≤..."
‚ùå "–ú—ã —Ä–∞–±–æ—Ç–∞–µ–º —Å –∏—Å–ø–æ–ª—å–∑–æ–≤–∞–Ω–∏–µ–º –ø—Ä–æ—Ñ–µ—Å—Å–∏–æ–Ω–∞–ª—å–Ω–æ–≥–æ –æ–±–æ—Ä—É–¥–æ–≤–∞–Ω–∏—è –∏ —ç–∫–æ–ª–æ–≥–∏—á–Ω—ã—Ö —Å—Ä–µ–¥—Å—Ç–≤..."
‚úÖ "–ü—Ä–∏–µ–∑–∂–∞–µ–º —Å –ø—Ä–æ—Ñ–µ—Å—Å–∏–æ–Ω–∞–ª—å–Ω–æ–π —Ç–µ—Ö–Ω–∏–∫–æ–π –∏ –±–µ–∑–æ–ø–∞—Å–Ω—ã–º–∏ —Å—Ä–µ–¥—Å—Ç–≤–∞–º–∏. –í—Å—ë –ø—Ä–æ–≤–µ—Ä–µ–Ω–æ - –Ω–∏–∫–∞–∫–æ–π —Ö–∏–º–∏–∏, –∫–æ—Ç–æ—Ä–∞—è –º–æ–≥–ª–∞ –±—ã –Ω–∞–≤—Ä–µ–¥–∏—Ç—å –¥–µ—Ç—è–º –∏–ª–∏ –¥–æ–º–∞—à–Ω–∏–º –∂–∏–≤–æ—Ç–Ω—ã–º..."
‚ùå "–ü—Ä–µ–¥–ª–∞–≥–∞–µ–º —Ä–∞–∑–ª–∏—á–Ω—ã–µ –≤–∏–¥—ã —É–±–æ—Ä–∫–∏: –≥–µ–Ω–µ—Ä–∞–ª—å–Ω–∞—è, –ø–æ–¥–¥–µ—Ä–∂–∏–≤–∞—é—â–∞—è, –ø–æ—Å–ª–µ —Ä–µ–º–æ–Ω—Ç–∞..."
‚úÖ "–î–µ–ª–∞–µ–º –≤—Å—ë: –æ—Ç –≥–µ–Ω–µ—Ä–∞–ª—å–Ω–æ–π —É–±–æ—Ä–∫–∏ —Ä–∞–∑ –≤ –º–µ—Å—è—Ü –¥–æ –µ–∂–µ–¥–Ω–µ–≤–Ω–æ–≥–æ –ø–æ–¥–¥–µ—Ä–∂–∞–Ω–∏—è —á–∏—Å—Ç–æ—Ç—ã. –ù–µ–¥–∞–≤–Ω–æ –ø–æ–º–æ–≥–ª–∏ —Å–µ–º—å–µ —Å —É–±–æ—Ä–∫–æ–π –ø–æ—Å–ª–µ —Ä–µ–º–æ–Ω—Ç–∞ - –ø—Ä–∏—à–ª–æ—Å—å –ø—Ä–∏–ª–æ–∂–∏—Ç—å —É—Å–∏–ª–∏—è, –Ω–æ —Ä–µ–∑—É–ª—å—Ç–∞—Ç —Ç–æ–≥–æ —Å—Ç–æ–∏–ª..."
‚ùå "–ë–∞–Ω–∫–æ–≤—Å–∫–∏–µ –∫–∞—Ä—Ç—ã - —ç—Ç–æ —Å–æ–≤—Ä–µ–º–µ–Ω–Ω—ã–π —Å–ø–æ—Å–æ–± –æ–ø–ª–∞—Ç—ã, –∫–æ—Ç–æ—Ä—ã–π –¥–µ–ª–∞–µ—Ç –∂–∏–∑–Ω—å –ø—Ä–æ—â–µ..."
‚úÖ "–ü–æ–º–Ω–∏—Ç–µ, –∫–∞–∫ —Ä–∞–Ω—å—à–µ –Ω—É–∂–Ω–æ –±—ã–ª–æ –Ω–æ—Å–∏—Ç—å —Å —Å–æ–±–æ–π –Ω–∞–ª–∏—á–Ω—ã–µ? –°–µ–π—á–∞—Å –≤—Å—ë –∏–∑–º–µ–Ω–∏–ª–æ—Å—å. –ë–∞–Ω–∫–æ–≤—Å–∫–∞—è –∫–∞—Ä—Ç–∞ –≤ –∫–∞—Ä–º–∞–Ω–µ - –∏ –º–æ–∂–µ—à—å —Ä–∞—Å–ø–ª–∞—á–∏–≤–∞—Ç—å—Å—è –≤–µ–∑–¥–µ..."
‚ùå "–ú–æ–Ω—Ç–∞–∂ –≤–∏–¥–µ–æ–Ω–∞–±–ª—é–¥–µ–Ω–∏—è –≤–∫–ª—é—á–∞–µ—Ç —É—Å—Ç–∞–Ω–æ–≤–∫—É –∫–∞–º–µ—Ä, —Ä–µ–≥–∏—Å—Ç—Ä–∞—Ç–æ—Ä–æ–≤..."
‚úÖ "–ö–æ–≥–¥–∞ —É—Å—Ç–∞–Ω–∞–≤–ª–∏–≤–∞–µ—à—å –≤–∏–¥–µ–æ–Ω–∞–±–ª—é–¥–µ–Ω–∏–µ, –Ω—É–∂–Ω–æ —É—á–∏—Ç—ã–≤–∞—Ç—å –Ω–µ—Å–∫–æ–ª—å–∫–æ –º–æ–º–µ–Ω—Ç–æ–≤. –ö–∞–º–µ—Ä—ã —Ä–∞–∑–º–µ—â–∞–µ–º —Ç–∞–∫, —á—Ç–æ–±—ã –æ—Ö–≤–∞—Ç–∏—Ç—å –≤—Å–µ –≤–∞–∂–Ω—ã–µ –∑–æ–Ω—ã..."
‚ùå "–®–≤–µ–π—Ü–∞—Ä—Å–∫–∏–µ —á–∞—Å—ã –∏–º–µ—é—Ç —Ç–æ—á–Ω—ã–µ –º–µ—Ö–∞–Ω–∏–∑–º—ã –∏ –¥—Ä–∞–≥–æ—Ü–µ–Ω–Ω—ã–µ –º–µ—Ç–∞–ª–ª—ã..."
‚úÖ "–®–≤–µ–π—Ü–∞—Ä—Å–∫–∏–µ —á–∞—Å—ã - —ç—Ç–æ –Ω–µ –ø—Ä–æ—Å—Ç–æ –∞–∫—Å–µ—Å—Å—É–∞—Ä. –ú–∞—Å—Ç–µ—Ä–∞ –≥–æ–¥–∞–º–∏ –æ—Ç—Ç–∞—á–∏–≤–∞—é—Ç –º–µ—Ö–∞–Ω–∏–∑–º, —Ä–∞–±–æ—Ç–∞—é—Ç —Å –∑–æ–ª–æ—Ç–æ–º –∏ –ø–ª–∞—Ç–∏–Ω–æ–π..."
‚ùå "–í–∞–∂–Ω–æ –ø–æ–Ω–∏–º–∞—Ç—å, —á—Ç–æ —Å—Ç–æ–∏–º–æ—Å—Ç—å –∑–∞–≤–∏—Å–∏—Ç –æ—Ç..."
‚úÖ "–°—Ç–æ–∏–º–æ—Å—Ç—å –º–æ–∂–µ—Ç –±—ã—Ç—å —Ä–∞–∑–Ω–æ–π - –≤—Å—ë –∑–∞–≤–∏—Å–∏—Ç –æ—Ç —Ç–æ–≥–æ, —á—Ç–æ –∏–º–µ–Ω–Ω–æ –Ω—É–∂–Ω–æ..."

–¢—Ä–µ–±–æ–≤–∞–Ω–∏—è –∫ —Å—Ç—Ä—É–∫—Ç—É—Ä–µ:
1. –ó–∞—Ü–µ–ø–∫–∞ (1-2 –ø—Ä–µ–¥–ª–æ–∂–µ–Ω–∏—è) - –Ω–∞ –æ—Å–Ω–æ–≤–µ —Ä–µ–∞–ª—å–Ω–æ–π —Ç–µ–º—ã –∏–∑ –æ–ø–∏—Å–∞–Ω–∏—è, –ù–ï —à–∞–±–ª–æ–Ω–Ω–∞—è, –ë–ï–ó —ç–º–æ–¥–∑–∏ –≤ –Ω–∞—á–∞–ª–µ
2. –û—Å–Ω–æ–≤–Ω–æ–π –∫–æ–Ω—Ç–µ–Ω—Ç (10-15 –ø—Ä–µ–¥–ª–æ–∂–µ–Ω–∏–π) - –†–ê–°–ö–†–û–ô —Ç–µ–º—É –∏–∑ –æ–ø–∏—Å–∞–Ω–∏—è –ø–æ–ª–Ω–æ—Å—Ç—å—é:
   - –†–∞–∑–±–µ–π –Ω–∞ –∞–±–∑–∞—Ü—ã (–∫–∞–∂–¥—ã–π –∞–±–∑–∞—Ü 2-4 –ø—Ä–µ–¥–ª–æ–∂–µ–Ω–∏—è)
   - –ò—Å–ø–æ–ª—å–∑—É–π –∫–æ–Ω–∫—Ä–µ—Ç–Ω—ã–µ —Ñ–∞–∫—Ç—ã –∏ –∏–Ω—Ñ–æ—Ä–º–∞—Ü–∏—é –∏–∑ –æ–ø–∏—Å–∞–Ω–∏—è
   - –ü–∏—à–∏ –ø—Ä–æ—Å—Ç—ã–º–∏ –ø—Ä–µ–¥–ª–æ–∂–µ–Ω–∏—è–º–∏
   - –î–æ–±–∞–≤–ª—è–π –ø–µ—Ä–µ–Ω–æ—Å—ã —Å—Ç—Ä–æ–∫ –º–µ–∂–¥—É –∞–±–∑–∞—Ü–∞–º–∏ –¥–ª—è —á–∏—Ç–∞–µ–º–æ—Å—Ç–∏
3. –ü—Ä–∏–∑—ã–≤ –∫ –¥–µ–π—Å—Ç–≤–∏—é (1 –ø—Ä–µ–¥–ª–æ–∂–µ–Ω–∏–µ) - –µ—Å—Ç–µ—Å—Ç–≤–µ–Ω–Ω—ã–π, –Ω–µ –Ω–∞–≤—è–∑—á–∏–≤—ã–π

–í–ê–ñ–ù–û –¥–ª—è —Ñ–æ—Ä–º–∞—Ç–∏—Ä–æ–≤–∞–Ω–∏—è:
- –û–±—è–∑–∞—Ç–µ–ª—å–Ω–æ —Ä–∞–∑–±–∏–≤–∞–π —Ç–µ–∫—Å—Ç –Ω–∞ –∞–±–∑–∞—Ü—ã (–∏—Å–ø–æ–ª—å–∑—É–π –ø—É—Å—Ç—ã–µ —Å—Ç—Ä–æ–∫–∏ –º–µ–∂–¥—É –∞–±–∑–∞—Ü–∞–º–∏)
- –ö–∞–∂–¥—ã–π –∞–±–∑–∞—Ü = –æ—Ç–¥–µ–ª—å–Ω–∞—è –º—ã—Å–ª—å (2-4 –ø—Ä–µ–¥–ª–æ–∂–µ–Ω–∏—è)
- –ù–ï –ø–∏—à–∏ –≤–µ—Å—å —Ç–µ–∫—Å—Ç –æ–¥–Ω–∏–º –¥–ª–∏–Ω–Ω—ã–º –∞–±–∑–∞—Ü–µ–º
- –ü–æ—Å–ª–µ –∫–∞–∂–¥–æ–≥–æ –∞–±–∑–∞—Ü–∞ –¥–µ–ª–∞–π –ø–µ—Ä–µ–Ω–æ—Å —Å—Ç—Ä–æ–∫–∏ (–ø—É—Å—Ç–∞—è —Å—Ç—Ä–æ–∫–∞)

–î–ª–∏–Ω–∞: –¥–æ 1500 —Å–∏–º–≤–æ–ª–æ–≤, –ø–æ—Å—Ç –¥–æ–ª–∂–µ–Ω –±—ã—Ç—å –ó–ê–í–ï–†–®–ï–ù–ù–´–ú –∏ –∏–Ω—Ñ–æ—Ä–º–∞—Ç–∏–≤–Ω—ã–º.
–ò—Å–ø–æ–ª—å–∑—É–π —ç–º–æ–¥–∑–∏ —É–º–µ—Ä–µ–Ω–Ω–æ (1-2 —ç–º–æ–¥–∑–∏), –Ω–æ –ù–ï –≤ –Ω–∞—á–∞–ª–µ –∫–∞–∫ –∑–∞—Ü–µ–ø–∫—É.
–ù–ï –¥–æ–±–∞–≤–ª—è–π –±–ª–æ–∫–∏ "–ü–æ—Ö–æ–∂–∏–µ —Å–æ–±—ã—Ç–∏—è", "Similar events", –∏—Å—Ç–æ—Ä–∏—á–µ—Å–∫–∏–µ –¥–∞–Ω–Ω—ã–µ –∏–ª–∏ —Å–æ–±—ã—Ç–∏—è –∑–∞ –ø–æ—Å–ª–µ–¥–Ω–∏–µ –≥–æ–¥—ã.
–ù–ï –æ–±—Ä—ã–≤–∞–π –ø–æ—Å—Ç –Ω–∞ –ø–æ–ª—É—Å–ª–æ–≤–µ - –æ–±—è–∑–∞—Ç–µ–ª—å–Ω–æ –∑–∞–≤–µ—Ä—à–∏ –º—ã—Å–ª—å.""",
                max_tokens=2000,  # –£–≤–µ–ª–∏—á–µ–Ω–æ –¥–ª—è –¥–ª–∏–Ω–Ω–æ–≥–æ –ø–æ—Å—Ç–∞ (1500 —Å–∏–º–≤–æ–ª–æ–≤ —Ç—Ä–µ–±—É–µ—Ç ~1125-1500 —Ç–æ–∫–µ–Ω–æ–≤, –±–µ—Ä–µ–º —Å –∑–∞–ø–∞—Å–æ–º)
                temperature=0.85,  # –ü–æ–≤—ã—à–µ–Ω–æ –¥–ª—è –±–æ–ª—å—à–µ–π –µ—Å—Ç–µ—Å—Ç–≤–µ–Ω–Ω–æ—Å—Ç–∏ –∏ –≤–∞—Ä–∏–∞—Ç–∏–≤–Ω–æ—Å—Ç–∏
                system_message="""–¢—ã –æ–ø—ã—Ç–Ω—ã–π –∫–æ–Ω—Ç–µ–Ω—Ç-–º–µ–π–∫–µ—Ä, –∫–æ—Ç–æ—Ä—ã–π –ø–∏—à–µ—Ç –ø–æ—Å—Ç—ã –¥–ª—è —Å–æ—Ü–∏–∞–ª—å–Ω—ã—Ö —Å–µ—Ç–µ–π. –¢–≤–æ—è –≥–ª–∞–≤–Ω–∞—è –∑–∞–¥–∞—á–∞ - –ø–∏—Å–∞—Ç—å —Ç–∞–∫, —á—Ç–æ–±—ã –ø–æ—Å—Ç –≤—ã–≥–ª—è–¥–µ–ª –∫–∞–∫ –Ω–∞–ø–∏—Å–∞–Ω–Ω—ã–π –∂–∏–≤—ã–º —á–µ–ª–æ–≤–µ–∫–æ–º, –∞ –Ω–µ –ò–ò.

–ö–†–ò–¢–ò–ß–ï–°–ö–ò –í–ê–ñ–ù–û:
- –ù–ï –∏—Å–ø–æ–ª—å–∑—É–π —à–∞–±–ª–æ–Ω–Ω—ã–µ –º–∞—Ä–∫–µ—Ç–∏–Ω–≥–æ–≤—ã–µ —Ñ—Ä–∞–∑—ã: "—É–∑–Ω–∞–π—Ç–µ —Å–µ–∫—Ä–µ—Ç", "—Ä–µ–≤–æ–ª—é—Ü–∏–æ–Ω–Ω–æ–µ —Ä–µ—à–µ–Ω–∏–µ", "–≤–∞—à –∫–ª—é—á –∫ —É—Å–ø–µ—Ö—É", "–æ—Ç–∫—Ä–æ–π—Ç–µ –¥–ª—è —Å–µ–±—è", "–Ω–µ —É–ø—É—Å—Ç–∏—Ç–µ –≤–æ–∑–º–æ–∂–Ω–æ—Å—Ç—å"
- –ù–ï –∏—Å–ø–æ–ª—å–∑—É–π –∫–ª–∏—à–µ: "–±—É–¥—É—â–µ–µ —É–∂–µ –∑–¥–µ—Å—å", "–∏–∑–º–µ–Ω–∏—Ç–µ —Å–≤–æ—é –∂–∏–∑–Ω—å", "—Å—Ç–∞–Ω—å—Ç–µ –ª—É—á—à–µ–π –≤–µ—Ä—Å–∏–µ–π —Å–µ–±—è"
- –ù–ï –∏—Å–ø–æ–ª—å–∑—É–π —à–∞–±–ª–æ–Ω–Ω—ã–µ –∑–∞—Ü–µ–ø–∫–∏ —Å —ç–º–æ–¥–∑–∏: "üí° –û—Ç–∫—Ä—ã–≤–∞–µ–º —Å–µ–∫—Ä–µ—Ç—ã", "üöÄ –ù–æ–≤—ã–µ —Ç–µ—Ö–Ω–æ–ª–æ–≥–∏–∏", "üí° –ó–Ω–∞–µ—Ç–µ –ª–∏ –≤—ã", "üéØ –•–æ—Ç–∏—Ç–µ —É–∑–Ω–∞—Ç—å —Å–µ–∫—Ä–µ—Ç"
- –ù–ï –Ω–∞—á–∏–Ω–∞–π –ø–æ—Å—Ç —Å —ç–º–æ–¥–∑–∏-–∑–∞—Ü–µ–ø–æ–∫ - –∏—Å–ø–æ–ª—å–∑—É–π —ç–º–æ–¥–∑–∏ —Ç–æ–ª—å–∫–æ –µ—Å—Ç–µ—Å—Ç–≤–µ–Ω–Ω–æ –≤ –∫–æ–Ω—Ç–µ–∫—Å—Ç–µ
- –°–¢–†–û–ì–û –ó–ê–ü–†–ï–©–ï–ù–û —Ç–µ—Ö–Ω–∏—á–µ—Å–∫–∏–µ —Ñ–æ—Ä–º—É–ª–∏—Ä–æ–≤–∫–∏ –∫–∞–∫ –≤ –∫–∞—Ç–∞–ª–æ–≥–µ: "–≤–∫–ª—é—á–∞–µ—Ç", "–∏—Å–ø–æ–ª—å–∑—É—é—Ç", "–∏–º–µ–µ—Ç", "–ø–æ–¥—Ä–∞–∑—É–º–µ–≤–∞–µ—Ç", "–æ–±–µ—Å–ø–µ—á–∏–≤–∞–µ—Ç", "–ø—Ä–µ–¥—É—Å–º–∞—Ç—Ä–∏–≤–∞–µ—Ç"
- –°–¢–†–û–ì–û –ó–ê–ü–†–ï–©–ï–ù–û —Ñ–æ—Ä–º–∞–ª—å–Ω—ã–µ –∫–æ–Ω—Å—Ç—Ä—É–∫—Ü–∏–∏: "–í–∞–∂–Ω–æ –ø–æ–Ω–∏–º–∞—Ç—å, —á—Ç–æ...", "–ù–µ–æ–±—Ö–æ–¥–∏–º–æ –æ—Ç–º–µ—Ç–∏—Ç—å...", "–°–ª–µ–¥—É–µ—Ç —É—á–∏—Ç—ã–≤–∞—Ç—å..."
- –ù–ï –ø–∏—à–∏ —Å–ø–∏—Å–∫–∞–º–∏ –±–µ–∑ –∫–æ–Ω—Ç–µ–∫—Å—Ç–∞ - –æ–ø–∏—Å—ã–≤–∞–π –µ—Å—Ç–µ—Å—Ç–≤–µ–Ω–Ω–æ –≤ –ø—Ä–µ–¥–ª–æ–∂–µ–Ω–∏—è—Ö
- –ü–∏—à–∏ –ø—Ä–æ—Å—Ç–æ –∏ –ø–æ–Ω—è—Ç–Ω–æ, –∫–∞–∫ –±—É–¥—Ç–æ –æ–±—ä—è—Å–Ω—è–µ—à—å –¥—Ä—É–≥—É –∏–ª–∏ –∫–æ–ª–ª–µ–≥–µ
- –ò—Å–ø–æ–ª—å–∑—É–π –∫–æ–Ω–∫—Ä–µ—Ç–Ω—ã–µ —Ñ–∞–∫—Ç—ã –∏ –ø—Ä–∏–º–µ—Ä—ã –∏–∑ –æ–ø–∏—Å–∞–Ω–∏—è —Ç–µ–º—ã
- –î–æ–ø—É—Å–∫–∞–π –Ω–µ–±–æ–ª—å—à–∏–µ –Ω–µ—Ñ–æ—Ä–º–∞–ª—å–Ω–æ—Å—Ç–∏ –∏ —Ä–∞–∑–≥–æ–≤–æ—Ä–Ω—ã–µ –æ–±–æ—Ä–æ—Ç—ã
- –ò–∑–±–µ–≥–∞–π –∏–∑–ª–∏—à–Ω–µ–π —Ñ–æ—Ä–º–∞–ª—å–Ω–æ—Å—Ç–∏ –∏ "–ø—Ä–æ–¥–∞—é—â–µ–≥–æ" —Ç–æ–Ω–∞
- –ü–∏—à–∏ –æ—Ç –ø–µ—Ä–≤–æ–≥–æ –ª–∏—Ü–∞ –≥–¥–µ —É–º–µ—Å—Ç–Ω–æ ("—è –∑–∞–º–µ—Ç–∏–ª", "–≤ –º–æ–µ–º –æ–ø—ã—Ç–µ", "—Å—Ç–∞–ª–∫–∏–≤–∞–ª—Å—è —Å")
- –ù–µ –±–æ–π—Å—è –∏—Å–ø–æ–ª—å–∑–æ–≤–∞—Ç—å –ø—Ä–æ—Å—Ç—ã–µ —Å–ª–æ–≤–∞ –≤–º–µ—Å—Ç–æ —Å–ª–æ–∂–Ω—ã—Ö —Ç–µ—Ä–º–∏–Ω–æ–≤
- –î–æ–±–∞–≤–ª—è–π –ª–∏—á–Ω—ã–µ –Ω–∞–±–ª—é–¥–µ–Ω–∏—è –∏ —Ä–µ–∞–ª—å–Ω—ã–π –æ–ø—ã—Ç
- –ë—É–¥—å –∫–æ–Ω–∫—Ä–µ—Ç–Ω—ã–º, –∏–∑–±–µ–≥–∞–π –æ–±—â–∏—Ö —Ñ—Ä–∞–∑
- –ù–ò–ö–û–ì–î–ê –Ω–µ –¥–æ–±–∞–≤–ª—è–π –º–µ—Ç–∞–¥–∞–Ω–Ω—ã–µ —Ç–∏–ø–∞ "–ù–∞—à–∏ —Ü–µ–ª–∏:", "–ë–∏–∑–Ω–µ—Å-—Ü–µ–ª–∏:", —Ç–µ—Ö–Ω–∏—á–µ—Å–∫–∏–µ –¥–∞–Ω–Ω—ã–µ –∏–ª–∏ ID –≤ —Ç–µ–∫—Å—Ç –ø–æ—Å—Ç–∞

–¶–µ–ª—å: –ø–æ—Å—Ç –¥–æ–ª–∂–µ–Ω —á–∏—Ç–∞—Ç—å—Å—è –∫–∞–∫ –Ω–∞–ø–∏—Å–∞–Ω–Ω—ã–π —Ä–µ–∞–ª—å–Ω—ã–º —á–µ–ª–æ–≤–µ–∫–æ–º, –∫–æ—Ç–æ—Ä—ã–π —Ä–∞–∑–±–∏—Ä–∞–µ—Ç—Å—è –≤ —Ç–µ–º–µ –∏ –¥–µ–ª–∏—Ç—Å—è –∑–Ω–∞–Ω–∏—è–º–∏, –∞ –Ω–µ –∫–∞–∫ —Ä–µ–∫–ª–∞–º–Ω—ã–π —Ç–µ–∫—Å—Ç, –æ–ø–∏—Å–∞–Ω–∏–µ –∫–∞—Ç–∞–ª–æ–≥–∞ –∏–ª–∏ –ò–ò-–≥–µ–Ω–µ—Ä–∞—Ü–∏—è.
–ù–ï –¥–æ–±–∞–≤–ª—è–π –±–ª–æ–∫–∏ —Å –ø–æ—Ö–æ–∂–∏–º–∏ —Å–æ–±—ã—Ç–∏—è–º–∏, –∏—Å—Ç–æ—Ä–∏—á–µ—Å–∫–∏–º–∏ –¥–∞–Ω–Ω—ã–º–∏ –∏–ª–∏ —Å–æ–±—ã—Ç–∏—è–º–∏ –∑–∞ –ø–æ—Å–ª–µ–¥–Ω–∏–µ –≥–æ–¥—ã.""",
                examples=[
                    "–í—á–µ—Ä–∞ —Å—Ç–æ–ª–∫–Ω—É–ª—Å—è —Å –ø—Ä–æ–±–ª–µ–º–æ–π X. –û–∫–∞–∑–∞–ª–æ—Å—å, —Ä–µ—à–µ–Ω–∏–µ –ø—Ä–æ—Å—Ç–æ–µ - –Ω—É–∂–Ω–æ Y. –í–æ—Ç –∫–∞–∫ —è —ç—Ç–æ —Å–¥–µ–ª–∞–ª...",
                    "–ú–Ω–æ–≥–∏–µ —Å–ø—Ä–∞—à–∏–≤–∞—é—Ç –ø—Ä–æ Z. –ù–∞ —Å–∞–º–æ–º –¥–µ–ª–µ, —ç—Ç–æ –Ω–µ —Ç–∞–∫ —Å–ª–æ–∂–Ω–æ, –∫–∞–∫ –∫–∞–∂–µ—Ç—Å—è. –†–∞—Å—Å–∫–∞–∂—É –Ω–∞ —Å–≤–æ–µ–º –ø—Ä–∏–º–µ—Ä–µ...",
                    "–†–∞–±–æ—Ç–∞—é —Å —ç—Ç–∏–º —É–∂–µ 3 –≥–æ–¥–∞. –ó–∞–º–µ—Ç–∏–ª, —á—Ç–æ –±–æ–ª—å—à–∏–Ω—Å—Ç–≤–æ –ª—é–¥–µ–π –¥–µ–ª–∞—é—Ç –æ–¥–Ω—É –∏ —Ç—É –∂–µ –æ—à–∏–±–∫—É...",
                    "–®–≤–µ–π—Ü–∞—Ä—Å–∫–∏–µ —á–∞—Å—ã - —ç—Ç–æ –Ω–µ –ø—Ä–æ—Å—Ç–æ –∞–∫—Å–µ—Å—Å—É–∞—Ä. –ö–æ–≥–¥–∞ –¥–µ—Ä–∂–∏—à—å –≤ —Ä—É–∫–∞—Ö –Ω–∞—Å—Ç–æ—è—â–∏–π –º–µ—Ö–∞–Ω–∏–∑–º, —á—É–≤—Å—Ç–≤—É–µ—à—å —Ä–∞–∑–Ω–∏—Ü—É. –ú–∞—Å—Ç–µ—Ä–∞ –≥–æ–¥–∞–º–∏ –æ—Ç—Ç–∞—á–∏–≤–∞—é—Ç –∫–∞–∂–¥—É—é –¥–µ—Ç–∞–ª—å, —Ä–∞–±–æ—Ç–∞—é—Ç —Å –∑–æ–ª–æ—Ç–æ–º –∏ –ø–ª–∞—Ç–∏–Ω–æ–π...",
                    "–£—Å—Ç–∞–Ω–∞–≤–ª–∏–≤–∞–ª–∏ –Ω–∞ –ø—Ä–æ—à–ª–æ–π –Ω–µ–¥–µ–ª–µ —Å–∏—Å—Ç–µ–º—É –≤–∏–¥–µ–æ–Ω–∞–±–ª—é–¥–µ–Ω–∏—è –¥–ª—è –æ—Ñ–∏—Å–∞. –ö–∞–º–µ—Ä—ã —Ä–∞–∑–º–µ—Å—Ç–∏–ª–∏ —Ç–∞–∫, —á—Ç–æ–±—ã –æ—Ö–≤–∞—Ç–∏—Ç—å –≤—Å–µ –≤—Ö–æ–¥—ã –∏ –≤–∞–∂–Ω—ã–µ –∑–æ–Ω—ã. –¢–µ–ø–µ—Ä—å –∫–ª–∏–µ–Ω—Ç –º–æ–∂–µ—Ç –≤–∏–¥–µ—Ç—å —á—Ç–æ –ø—Ä–æ–∏—Å—Ö–æ–¥–∏—Ç –¥–∞–∂–µ —É–¥–∞–ª–µ–Ω–Ω–æ..."
                ]
            ),
            "vk_post": ContentPrompt(
                platform="vk",
                content_type="post",
                prompt_template="""–ù–∞–ø–∏—à–∏ –ø–æ—Å—Ç –¥–ª—è VK –Ω–∞ —Ç–µ–º—É: {topic}

–¶–µ–ª–µ–≤–∞—è –∞—É–¥–∏—Ç–æ—Ä–∏—è: {target_audience}
–¢–æ–Ω: {tone} (–µ—Å—Ç–µ—Å—Ç–≤–µ–Ω–Ω—ã–π, —Ä–∞–∑–≥–æ–≤–æ—Ä–Ω—ã–π)
–ö–ª—é—á–µ–≤—ã–µ —Å–ª–æ–≤–∞: {keywords}

–í–ê–ñ–ù–û - –ü–ò–®–ò –ö–ê–ö –ñ–ò–í–û–ô –ß–ï–õ–û–í–ï–ö:
- –ù–ï –∏—Å–ø–æ–ª—å–∑—É–π –º–∞—Ä–∫–µ—Ç–∏–Ω–≥–æ–≤—ã–µ –∫–ª–∏—à–µ –∏ —à–∞–±–ª–æ–Ω–Ω—ã–µ —Ñ—Ä–∞–∑—ã
- –ü–∏—à–∏ –≤ —Ä–∞–∑–≥–æ–≤–æ—Ä–Ω–æ–º —Å—Ç–∏–ª–µ, –∫–∞–∫ –±—É–¥—Ç–æ –æ–±—â–∞–µ—à—å—Å—è —Å –¥—Ä—É–∑—å—è–º–∏
- –ò—Å–ø–æ–ª—å–∑—É–π –∫–æ–Ω–∫—Ä–µ—Ç–Ω—ã–µ —Ñ–∞–∫—Ç—ã –∏–∑ –æ–ø–∏—Å–∞–Ω–∏—è
- –î–æ–ø—É—Å–∫–∞–π –Ω–µ—Ñ–æ—Ä–º–∞–ª—å–Ω–æ—Å—Ç–∏ –∏ —Ä–∞–∑–≥–æ–≤–æ—Ä–Ω—ã–µ –æ–±–æ—Ä–æ—Ç—ã

–¢—Ä–µ–±–æ–≤–∞–Ω–∏—è:
- –ñ–∏–≤–æ–π, —Ä–∞–∑–≥–æ–≤–æ—Ä–Ω—ã–π —Å—Ç–∏–ª—å
- –í–æ–ø—Ä–æ—Å—ã –¥–ª—è –≤–æ–≤–ª–µ—á–µ–Ω–∏—è –∞—É–¥–∏—Ç–æ—Ä–∏–∏
- –†–µ–ª–µ–≤–∞–Ω—Ç–Ω—ã–µ —Ö–µ—à—Ç–µ–≥–∏
- –î–ª–∏–Ω–∞: –¥–æ 300 —Å–∏–º–≤–æ–ª–æ–≤
- –ù–ï –¥–æ–±–∞–≤–ª—è–π –±–ª–æ–∫–∏ "–ü–æ—Ö–æ–∂–∏–µ —Å–æ–±—ã—Ç–∏—è", "Similar events", –∏—Å—Ç–æ—Ä–∏—á–µ—Å–∫–∏–µ –¥–∞–Ω–Ω—ã–µ –∏–ª–∏ —Å–æ–±—ã—Ç–∏—è –∑–∞ –ø–æ—Å–ª–µ–¥–Ω–∏–µ –≥–æ–¥—ã

–°—Ç—Ä—É–∫—Ç—É—Ä–∞:
1. –ó–∞—Ü–µ–ø–∫–∞ —Å –≤–æ–ø—Ä–æ—Å–æ–º (–µ—Å—Ç–µ—Å—Ç–≤–µ–Ω–Ω–∞—è, –Ω–µ —à–∞–±–ª–æ–Ω–Ω–∞—è)
2. –û—Å–Ω–æ–≤–Ω–∞—è –∏–Ω—Ñ–æ—Ä–º–∞—Ü–∏—è (–∫–æ–Ω–∫—Ä–µ—Ç–Ω–∞—è, –∏–∑ –æ–ø–∏—Å–∞–Ω–∏—è)
3. –ü—Ä–∏–∑—ã–≤ –∫ –æ–±—Å—É–∂–¥–µ–Ω–∏—é (–Ω–µ –Ω–∞–≤—è–∑—á–∏–≤—ã–π)""",
                max_tokens=150,
                temperature=0.85,  # –ü–æ–≤—ã—à–µ–Ω–æ –¥–ª—è –µ—Å—Ç–µ—Å—Ç–≤–µ–Ω–Ω–æ—Å—Ç–∏
                system_message="""–¢—ã —Å–æ–∑–¥–∞–µ—à—å –∫–æ–Ω—Ç–µ–Ω—Ç –¥–ª—è VK - —Å–æ—Ü–∏–∞–ª—å–Ω–æ–π —Å–µ—Ç–∏ —Å –∂–∏–≤—ã–º –æ–±—â–µ–Ω–∏–µ–º. –ü–∏—à–∏ –≤ —Ä–∞–∑–≥–æ–≤–æ—Ä–Ω–æ–º —Å—Ç–∏–ª–µ, –∫–∞–∫ –∂–∏–≤–æ–π —á–µ–ª–æ–≤–µ–∫ –æ–±—â–∞–µ—Ç—Å—è —Å –¥—Ä—É–∑—å—è–º–∏. 

–ö–†–ò–¢–ò–ß–ï–°–ö–ò –í–ê–ñ–ù–û:
- –ù–ï –∏—Å–ø–æ–ª—å–∑—É–π –º–∞—Ä–∫–µ—Ç–∏–Ω–≥–æ–≤—ã–µ –∫–ª–∏—à–µ –∏ —à–∞–±–ª–æ–Ω–Ω—ã–µ —Ñ—Ä–∞–∑—ã
- –ü–∏—à–∏ –ø—Ä–æ—Å—Ç–æ –∏ –µ—Å—Ç–µ—Å—Ç–≤–µ–Ω–Ω–æ, –∏—Å–ø–æ–ª—å–∑—É–π —Ä–∞–∑–≥–æ–≤–æ—Ä–Ω—ã–µ –æ–±–æ—Ä–æ—Ç—ã
- –ó–∞–¥–∞–≤–∞–π –≤–æ–ø—Ä–æ—Å—ã –¥–ª—è –≤–æ–≤–ª–µ—á–µ–Ω–∏—è, –Ω–æ –µ—Å—Ç–µ—Å—Ç–≤–µ–Ω–Ω—ã–µ, –Ω–µ —à–∞–±–ª–æ–Ω–Ω—ã–µ
- –ò—Å–ø–æ–ª—å–∑—É–π –∫–æ–Ω–∫—Ä–µ—Ç–Ω—ã–µ —Ñ–∞–∫—Ç—ã –∏–∑ –æ–ø–∏—Å–∞–Ω–∏—è —Ç–µ–º—ã
- –ë—É–¥—å –¥—Ä—É–∂–µ–ª—é–±–Ω—ã–º, –Ω–æ –Ω–µ –Ω–∞–≤—è–∑—á–∏–≤—ã–º

–¶–µ–ª—å: –ø–æ—Å—Ç –¥–æ–ª–∂–µ–Ω –≤—ã–≥–ª—è–¥–µ—Ç—å –∫–∞–∫ –Ω–∞–ø–∏—Å–∞–Ω–Ω—ã–π —Ä–µ–∞–ª—å–Ω—ã–º —á–µ–ª–æ–≤–µ–∫–æ–º –≤ –ª–∏—á–Ω–æ–π –ø–µ—Ä–µ–ø–∏—Å–∫–µ –∏–ª–∏ –æ–±—Å—É–∂–¥–µ–Ω–∏–∏.
–ù–ï –¥–æ–±–∞–≤–ª—è–π –±–ª–æ–∫–∏ —Å –ø–æ—Ö–æ–∂–∏–º–∏ —Å–æ–±—ã—Ç–∏—è–º–∏, –∏—Å—Ç–æ—Ä–∏—á–µ—Å–∫–∏–º–∏ –¥–∞–Ω–Ω—ã–º–∏ –∏–ª–∏ —Å–æ–±—ã—Ç–∏—è–º–∏ –∑–∞ –ø–æ—Å–ª–µ–¥–Ω–∏–µ –≥–æ–¥—ã.""",
                examples=[
                    "–í—á–µ—Ä–∞ –ø–æ–ø—Ä–æ–±–æ–≤–∞–ª X –∏ –≤–æ—Ç —á—Ç–æ –ø–æ–ª—É—á–∏–ª–æ—Å—å. –ê –≤—ã –ø—Ä–æ–±–æ–≤–∞–ª–∏?",
                    "–°—Ç–æ–ª–∫–Ω—É–ª—Å—è —Å —Ç–∞–∫–æ–π —Å–∏—Ç—É–∞—Ü–∏–µ–π: Y. –ö—Ç–æ-–Ω–∏–±—É–¥—å —Å—Ç–∞–ª–∫–∏–≤–∞–ª—Å—è? –ö–∞–∫ —Ä–µ—à–∞–ª–∏?",
                    "–£–∂–µ –º–µ—Å—è—Ü –∏—Å–ø–æ–ª—å–∑—É—é Z. –ó–∞–º–µ—Ç–∏–ª –∏–Ω—Ç–µ—Ä–µ—Å–Ω—É—é –æ—Å–æ–±–µ–Ω–Ω–æ—Å—Ç—å... –ê —á—Ç–æ –¥—É–º–∞–µ—Ç–µ?"
                ]
            ),
            "instagram_post": ContentPrompt(
                platform="instagram",
                content_type="post",
                prompt_template="""–ù–∞–ø–∏—à–∏ –ø–æ—Å—Ç –¥–ª—è Instagram –Ω–∞ —Ç–µ–º—É: {topic}

–¶–µ–ª–µ–≤–∞—è –∞—É–¥–∏—Ç–æ—Ä–∏—è: {target_audience}
–¢–æ–Ω: {tone} (–µ—Å—Ç–µ—Å—Ç–≤–µ–Ω–Ω—ã–π, –∂–∏–≤–æ–π)
–ö–ª—é—á–µ–≤—ã–µ —Å–ª–æ–≤–∞: {keywords}

–í–ê–ñ–ù–û - –ü–ò–®–ò –ö–ê–ö –ñ–ò–í–û–ô –ß–ï–õ–û–í–ï–ö:
- –ù–ï –∏—Å–ø–æ–ª—å–∑—É–π —à–∞–±–ª–æ–Ω–Ω—ã–µ —Ñ—Ä–∞–∑—ã —Ç–∏–ø–∞ "–≤–¥–æ—Ö–Ω–æ–≤–µ–Ω–∏–µ –Ω–∞ –∫–∞–∂–¥—ã–π –¥–µ–Ω—å", "–Ω–æ–≤—ã–µ –≤–æ–∑–º–æ–∂–Ω–æ—Å—Ç–∏ –∂–¥—É—Ç"
- –ü–∏—à–∏ –µ—Å—Ç–µ—Å—Ç–≤–µ–Ω–Ω–æ, –∏—Å–ø–æ–ª—å–∑—É–π –∫–æ–Ω–∫—Ä–µ—Ç–Ω—ã–µ —Ñ–∞–∫—Ç—ã –∏–∑ –æ–ø–∏—Å–∞–Ω–∏—è
- –ò—Å–ø–æ–ª—å–∑—É–π —ç–º–æ–¥–∑–∏, –Ω–æ –Ω–µ –ø–µ—Ä–µ–±–æ—Ä—â–∏

–¢—Ä–µ–±–æ–≤–∞–Ω–∏—è:
- –í–∏–∑—É–∞–ª—å–Ω–æ –ø—Ä–∏–≤–ª–µ–∫–∞—Ç–µ–ª—å–Ω—ã–π —Ç–µ–∫—Å—Ç
- –≠–º–æ–¥–∑–∏ (2-4 —à—Ç—É–∫–∏, —É–º–µ—Ä–µ–Ω–Ω–æ)
- –•–µ—à—Ç–µ–≥–∏ –¥–ª—è –æ—Ö–≤–∞—Ç–∞
- –î–ª–∏–Ω–∞: –¥–æ 150 —Å–∏–º–≤–æ–ª–æ–≤
- –ù–ï –¥–æ–±–∞–≤–ª—è–π –±–ª–æ–∫–∏ "–ü–æ—Ö–æ–∂–∏–µ —Å–æ–±—ã—Ç–∏—è", "Similar events", –∏—Å—Ç–æ—Ä–∏—á–µ—Å–∫–∏–µ –¥–∞–Ω–Ω—ã–µ –∏–ª–∏ —Å–æ–±—ã—Ç–∏—è –∑–∞ –ø–æ—Å–ª–µ–¥–Ω–∏–µ –≥–æ–¥—ã

–°—Ç—Ä—É–∫—Ç—É—Ä–∞:
1. –≠–º–æ–¥–∑–∏ + –∑–∞—Ü–µ–ø–∫–∞ (–µ—Å—Ç–µ—Å—Ç–≤–µ–Ω–Ω–∞—è, –Ω–µ —à–∞–±–ª–æ–Ω–Ω–∞—è)
2. –ö—Ä–∞—Ç–∫–∞—è –∏–Ω—Ñ–æ—Ä–º–∞—Ü–∏—è (–∫–æ–Ω–∫—Ä–µ—Ç–Ω–∞—è, –∏–∑ –æ–ø–∏—Å–∞–Ω–∏—è)
3. –•–µ—à—Ç–µ–≥–∏""",
                max_tokens=100,
                temperature=0.9,
                system_message="""–¢—ã —Å–æ–∑–¥–∞–µ—à—å –∫–æ–Ω—Ç–µ–Ω—Ç –¥–ª—è Instagram - –≤–∏–∑—É–∞–ª—å–Ω–æ–π –ø–ª–∞—Ç—Ñ–æ—Ä–º—ã. –ü–∏—à–∏ –µ—Å—Ç–µ—Å—Ç–≤–µ–Ω–Ω–æ, –∫–∞–∫ –∂–∏–≤–æ–π —á–µ–ª–æ–≤–µ–∫ –¥–µ–ª–∏—Ç—Å—è –º–æ–º–µ–Ω—Ç–æ–º –∏–ª–∏ –º—ã—Å–ª—å—é.

–ö–†–ò–¢–ò–ß–ï–°–ö–ò –í–ê–ñ–ù–û:
- –ù–ï –∏—Å–ø–æ–ª—å–∑—É–π —à–∞–±–ª–æ–Ω–Ω—ã–µ —Ñ—Ä–∞–∑—ã: "–≤–¥–æ—Ö–Ω–æ–≤–µ–Ω–∏–µ –Ω–∞ –∫–∞–∂–¥—ã–π –¥–µ–Ω—å", "–Ω–æ–≤—ã–µ –≤–æ–∑–º–æ–∂–Ω–æ—Å—Ç–∏ –∂–¥—É—Ç", "–º–æ–º–µ–Ω—Ç –¥–ª—è –∏–∑–º–µ–Ω–µ–Ω–∏–π"
- –ü–∏—à–∏ –ø—Ä–æ—Å—Ç–æ –∏ –µ—Å—Ç–µ—Å—Ç–≤–µ–Ω–Ω–æ, –∏—Å–ø–æ–ª—å–∑—É–π –∫–æ–Ω–∫—Ä–µ—Ç–Ω—ã–µ —Ñ–∞–∫—Ç—ã –∏–∑ –æ–ø–∏—Å–∞–Ω–∏—è
- –ò—Å–ø–æ–ª—å–∑—É–π —ç–º–æ–¥–∑–∏ —É–º–µ—Ä–µ–Ω–Ω–æ, —Å–æ–∑–¥–∞–≤–∞–π –∞—Ç–º–æ—Å—Ñ–µ—Ä—É
- –ë—É–¥—å –∫–æ–Ω–∫—Ä–µ—Ç–Ω—ã–º, –∏–∑–±–µ–≥–∞–π –æ–±—â–∏—Ö —Ñ—Ä–∞–∑

–¶–µ–ª—å: –ø–æ—Å—Ç –¥–æ–ª–∂–µ–Ω –≤—ã–≥–ª—è–¥–µ—Ç—å –∫–∞–∫ –Ω–∞–ø–∏—Å–∞–Ω–Ω—ã–π —Ä–µ–∞–ª—å–Ω—ã–º —á–µ–ª–æ–≤–µ–∫–æ–º, –∫–æ—Ç–æ—Ä—ã–π –¥–µ–ª–∏—Ç—Å—è —Ä–µ–∞–ª—å–Ω—ã–º –æ–ø—ã—Ç–æ–º –∏–ª–∏ –º—ã—Å–ª—å—é.
–ù–ï –¥–æ–±–∞–≤–ª—è–π –±–ª–æ–∫–∏ —Å –ø–æ—Ö–æ–∂–∏–º–∏ —Å–æ–±—ã—Ç–∏—è–º–∏, –∏—Å—Ç–æ—Ä–∏—á–µ—Å–∫–∏–º–∏ –¥–∞–Ω–Ω—ã–º–∏ –∏–ª–∏ —Å–æ–±—ã—Ç–∏—è–º–∏ –∑–∞ –ø–æ—Å–ª–µ–¥–Ω–∏–µ –≥–æ–¥—ã.""",
                examples=[
                    "–í—á–µ—Ä–∞ –ø–æ–ø—Ä–æ–±–æ–≤–∞–ª –Ω–æ–≤—ã–π –ø–æ–¥—Ö–æ–¥ –∫ X. –†–µ–∑—É–ª—å—Ç–∞—Ç —É–¥–∏–≤–∏–ª! ‚ú®",
                    "–†–∞–±–æ—Ç–∞—é –Ω–∞–¥ Y —É–∂–µ –º–µ—Å—è—Ü. –í–æ—Ç —á—Ç–æ –∑–∞–º–µ—Ç–∏–ª... üí°",
                    "–°—Ç–æ–ª–∫–Ω—É–ª—Å—è —Å Z. –û–∫–∞–∑–∞–ª–æ—Å—å –ø—Ä–æ—â–µ, —á–µ–º –¥—É–º–∞–ª. –ö—Ç–æ –ø—Ä–æ–±–æ–≤–∞–ª? üöÄ"
                ]
            ),
            "twitter_post": ContentPrompt(
                platform="twitter",
                content_type="post",
                prompt_template="""–ù–∞–ø–∏—à–∏ —Ç–≤–∏—Ç –Ω–∞ —Ç–µ–º—É: {topic}

–¶–µ–ª–µ–≤–∞—è –∞—É–¥–∏—Ç–æ—Ä–∏—è: {target_audience}
–¢–æ–Ω: {tone} (–µ—Å—Ç–µ—Å—Ç–≤–µ–Ω–Ω—ã–π, –∂–∏–≤–æ–π)
–ö–ª—é—á–µ–≤—ã–µ —Å–ª–æ–≤–∞: {keywords}

–í–ê–ñ–ù–û - –ü–ò–®–ò –ö–ê–ö –ñ–ò–í–û–ô –ß–ï–õ–û–í–ï–ö:
- –ù–ï –∏—Å–ø–æ–ª—å–∑—É–π —à–∞–±–ª–æ–Ω–Ω—ã–µ —Ñ—Ä–∞–∑—ã —Ç–∏–ø–∞ "–∏–¥–µ—è –¥–Ω—è", "–≥–æ—Ä—è—á–∞—è —Ç–µ–º–∞", "–±—ã—Å—Ç—Ä—ã–π —Ñ–∞–∫—Ç"
- –ü–∏—à–∏ –æ—Å—Ç—Ä–æ—É–º–Ω–æ –∏ –ª–∞–∫–æ–Ω–∏—á–Ω–æ, –∏—Å–ø–æ–ª—å–∑—É–π –∫–æ–Ω–∫—Ä–µ—Ç–Ω—ã–µ —Ñ–∞–∫—Ç—ã –∏–∑ –æ–ø–∏—Å–∞–Ω–∏—è
- –ë—É–¥—å –µ—Å—Ç–µ—Å—Ç–≤–µ–Ω–Ω—ã–º, –Ω–µ —Ñ–æ—Ä–º–∞–ª—å–Ω—ã–º

–¢—Ä–µ–±–æ–≤–∞–Ω–∏—è:
- –û—Å—Ç—Ä–æ—É–º–Ω–æ –∏ –ª–∞–∫–æ–Ω–∏—á–Ω–æ
- –ò—Å–ø–æ–ª—å–∑—É–π —Ö–µ—à—Ç–µ–≥–∏
- –î–ª–∏–Ω–∞: –¥–æ 280 —Å–∏–º–≤–æ–ª–æ–≤
- –ú–æ–∂–µ—à—å –∏—Å–ø–æ–ª—å–∑–æ–≤–∞—Ç—å —Ç—Ä–µ–¥
- –ù–ï –¥–æ–±–∞–≤–ª—è–π –±–ª–æ–∫–∏ "–ü–æ—Ö–æ–∂–∏–µ —Å–æ–±—ã—Ç–∏—è", "Similar events", –∏—Å—Ç–æ—Ä–∏—á–µ—Å–∫–∏–µ –¥–∞–Ω–Ω—ã–µ –∏–ª–∏ —Å–æ–±—ã—Ç–∏—è –∑–∞ –ø–æ—Å–ª–µ–¥–Ω–∏–µ –≥–æ–¥—ã

–°—Ç—Ä—É–∫—Ç—É—Ä–∞:
1. –ó–∞—Ü–µ–ø–∫–∞ (–µ—Å—Ç–µ—Å—Ç–≤–µ–Ω–Ω–∞—è, –Ω–µ —à–∞–±–ª–æ–Ω–Ω–∞—è)
2. –û—Å–Ω–æ–≤–Ω–∞—è –º—ã—Å–ª—å (–∫–æ–Ω–∫—Ä–µ—Ç–Ω–∞—è, –∏–∑ –æ–ø–∏—Å–∞–Ω–∏—è)
3. –•–µ—à—Ç–µ–≥–∏""",
                max_tokens=100,
                temperature=0.85,  # –ü–æ–≤—ã—à–µ–Ω–æ –¥–ª—è –µ—Å—Ç–µ—Å—Ç–≤–µ–Ω–Ω–æ—Å—Ç–∏
                system_message="""–¢—ã —Å–æ–∑–¥–∞–µ—à—å —Ç–≤–∏—Ç—ã - –∫–æ—Ä–æ—Ç–∫–∏–µ, –æ—Å—Ç—Ä–æ—É–º–Ω—ã–µ —Å–æ–æ–±—â–µ–Ω–∏—è. –ü–∏—à–∏ –∫–∞–∫ –∂–∏–≤–æ–π —á–µ–ª–æ–≤–µ–∫ –¥–µ–ª–∏—Ç—Å—è –º—ã—Å–ª—å—é –∏–ª–∏ –Ω–∞–±–ª—é–¥–µ–Ω–∏–µ–º.

–ö–†–ò–¢–ò–ß–ï–°–ö–ò –í–ê–ñ–ù–û:
- –ù–ï –∏—Å–ø–æ–ª—å–∑—É–π —à–∞–±–ª–æ–Ω–Ω—ã–µ —Ñ—Ä–∞–∑—ã: "–∏–¥–µ—è –¥–Ω—è", "–≥–æ—Ä—è—á–∞—è —Ç–µ–º–∞", "–±—ã—Å—Ç—Ä—ã–π —Ñ–∞–∫—Ç"
- –ë—É–¥—å –ª–∞–∫–æ–Ω–∏—á–Ω—ã–º –∏ –∑–∞–ø–æ–º–∏–Ω–∞—é—â–∏–º—Å—è, –Ω–æ –µ—Å—Ç–µ—Å—Ç–≤–µ–Ω–Ω—ã–º
- –ò—Å–ø–æ–ª—å–∑—É–π –∫–æ–Ω–∫—Ä–µ—Ç–Ω—ã–µ —Ñ–∞–∫—Ç—ã –∏–∑ –æ–ø–∏—Å–∞–Ω–∏—è —Ç–µ–º—ã
- –ü–∏—à–∏ –æ—Å—Ç—Ä–æ—É–º–Ω–æ, –Ω–æ –Ω–µ –Ω–∞–≤—è–∑—á–∏–≤–æ
- –ò–∑–±–µ–≥–∞–π —Ñ–æ—Ä–º–∞–ª—å–Ω–æ—Å—Ç–∏

–¶–µ–ª—å: —Ç–≤–∏—Ç –¥–æ–ª–∂–µ–Ω –≤—ã–≥–ª—è–¥–µ—Ç—å –∫–∞–∫ –Ω–∞–ø–∏—Å–∞–Ω–Ω—ã–π —Ä–µ–∞–ª—å–Ω—ã–º —á–µ–ª–æ–≤–µ–∫–æ–º, –∫–æ—Ç–æ—Ä—ã–π –¥–µ–ª–∏—Ç—Å—è —Ä–µ–∞–ª—å–Ω–æ–π –º—ã—Å–ª—å—é –∏–ª–∏ –Ω–∞–±–ª—é–¥–µ–Ω–∏–µ–º.
–ù–ï –¥–æ–±–∞–≤–ª—è–π –±–ª–æ–∫–∏ —Å –ø–æ—Ö–æ–∂–∏–º–∏ —Å–æ–±—ã—Ç–∏—è–º–∏, –∏—Å—Ç–æ—Ä–∏—á–µ—Å–∫–∏–º–∏ –¥–∞–Ω–Ω—ã–º–∏ –∏–ª–∏ —Å–æ–±—ã—Ç–∏—è–º–∏ –∑–∞ –ø–æ—Å–ª–µ–¥–Ω–∏–µ –≥–æ–¥—ã.""",
                examples=[
                    "–ü–æ–ø—Ä–æ–±–æ–≤–∞–ª X. –û–∫–∞–∑–∞–ª–æ—Å—å, —á—Ç–æ Y —Ä–∞–±–æ—Ç–∞–µ—Ç –ª—É—á—à–µ, —á–µ–º —è –¥—É–º–∞–ª.",
                    "–ó–∞–º–µ—Ç–∏–ª –∏–Ω—Ç–µ—Ä–µ—Å–Ω—É—é –∑–∞–∫–æ–Ω–æ–º–µ—Ä–Ω–æ—Å—Ç—å: –∫–æ–≥–¥–∞ –¥–µ–ª–∞–µ—à—å Z, –ø–æ–ª—É—á–∞–µ—Ç—Å—è A. –ö—Ç–æ –µ—â–µ –∑–∞–º–µ—á–∞–ª?",
                    "–ú–µ—Å—è—Ü —Ä–∞–±–æ—Ç–∞—é —Å B. –í–æ—Ç —á—Ç–æ –≤—ã—è—Å–Ω–∏–ª –Ω–∞ –ø—Ä–∞–∫—Ç–∏–∫–µ..."
                ]
            )
        }
    
    def _initialize_ai_integrations(self):
        """–ò–Ω–∏—Ü–∏–∞–ª–∏–∑–∏—Ä—É–µ—Ç AI –∏–Ω—Ç–µ–≥—Ä–∞—Ü–∏–∏"""
        try:
            # –ò–Ω–∏—Ü–∏–∞–ª–∏–∑–∏—Ä—É–µ–º HuggingFaceMCP –µ—Å–ª–∏ –¥–æ—Å—Ç—É–ø–µ–Ω
            if is_mcp_enabled('huggingface'):
                self.huggingface_mcp = HuggingFaceMCP()
                logger.info("HuggingFaceMCP –∏–Ω–∏—Ü–∏–∞–ª–∏–∑–∏—Ä–æ–≤–∞–Ω –≤ DraftingAgent")
            else:
                logger.warning("HuggingFaceMCP –Ω–µ–¥–æ—Å—Ç—É–ø–µ–Ω - –±—É–¥–µ—Ç –∏—Å–ø–æ–ª—å–∑–æ–≤–∞—Ç—å—Å—è fallback")
            
            # –ò–Ω–∏—Ü–∏–∞–ª–∏–∑–∏—Ä—É–µ–º OpenAIMCP –µ—Å–ª–∏ –¥–æ—Å—Ç—É–ø–µ–Ω
            if is_mcp_enabled('openai'):
                self.openai_mcp = OpenAIMCP()
                logger.info("OpenAIMCP –∏–Ω–∏—Ü–∏–∞–ª–∏–∑–∏—Ä–æ–≤–∞–Ω –≤ DraftingAgent")
            else:
                logger.warning("OpenAIMCP –Ω–µ–¥–æ—Å—Ç—É–ø–µ–Ω - –±—É–¥–µ—Ç –∏—Å–ø–æ–ª—å–∑–æ–≤–∞—Ç—å—Å—è fallback")
                
        except Exception as e:
            logger.error(f"–û—à–∏–±–∫–∞ –∏–Ω–∏—Ü–∏–∞–ª–∏–∑–∞—Ü–∏–∏ AI –∏–Ω—Ç–µ–≥—Ä–∞—Ü–∏–π: {e}")
            self.huggingface_mcp = None
            self.openai_mcp = None
    
    def can_handle_task(self, task: Task) -> bool:
        """
        –ü—Ä–æ–≤–µ—Ä—è–µ—Ç, –º–æ–∂–µ—Ç –ª–∏ DraftingAgent –≤—ã–ø–æ–ª–Ω–∏—Ç—å –∑–∞–¥–∞—á—É
        –ù–ï –æ–±—Ä–∞–±–∞—Ç—ã–≤–∞–µ—Ç –∑–∞–¥–∞—á–∏ –ø—É–±–ª–∏–∫–∞—Ü–∏–∏ (—Å 'Publish' –≤ –Ω–∞–∑–≤–∞–Ω–∏–∏)
        """
        # –°–Ω–∞—á–∞–ª–∞ –ø—Ä–æ–≤–µ—Ä—è–µ–º –±–∞–∑–æ–≤—ã–µ —É—Å–ª–æ–≤–∏—è
        if not super().can_handle_task(task):
            return False
        
        # DraftingAgent –ù–ï –æ–±—Ä–∞–±–∞—Ç—ã–≤–∞–µ—Ç –∑–∞–¥–∞—á–∏ –ø—É–±–ª–∏–∫–∞—Ü–∏–∏
        if "Publish" in task.name or "publish" in task.name.lower():
            return False
        
        return True
    
    async def execute_task(self, task: Task) -> Dict[str, Any]:
        """–í—ã–ø–æ–ª–Ω—è–µ—Ç –∑–∞–¥–∞—á—É —Å–æ–∑–¥–∞–Ω–∏—è –∫–æ–Ω—Ç–µ–Ω—Ç–∞"""
        try:
            logger.info(f"DraftingAgent –≤—ã–ø–æ–ª–Ω—è–µ—Ç –∑–∞–¥–∞—á—É: {task.name}")
            
            # –ò–∑–≤–ª–µ–∫–∞–µ–º –¥–∞–Ω–Ω—ã–µ –∏–∑ –∫–æ–Ω—Ç–µ–∫—Å—Ç–∞ –∑–∞–¥–∞—á–∏
            brief_data = task.context.get("brief_data", {})
            platform = task.context.get("platform", "telegram")
            content_type = task.context.get("content_type", "post")
            strategy_data = task.context.get("strategy", {})
            
            # –°–æ–∑–¥–∞–µ–º –∫–æ–Ω—Ç–µ–Ω—Ç
            generated_content = await self._generate_content(
                brief_data, platform, content_type, strategy_data
            )
            
            # –û–ø—Ç–∏–º–∏–∑–∏—Ä—É–µ–º –¥–ª—è –ø–ª–∞—Ç—Ñ–æ—Ä–º—ã
            optimized_content = await self._optimize_for_platform(
                generated_content, platform
            )
            
            # –ü—Ä–æ–≤–µ—Ä—è–µ–º –∫–∞—á–µ—Å—Ç–≤–æ
            quality_metrics = await self._assess_content_quality(optimized_content)
            
            result = {
                "task_id": task.id,
                "agent_id": self.agent_id,
                "content": {
                    "id": optimized_content.content_piece.id,
                    "title": optimized_content.content_piece.title,
                    "text": optimized_content.content_piece.text,
                    "hashtags": optimized_content.content_piece.hashtags,
                    "call_to_action": optimized_content.content_piece.call_to_action,
                    "platform": platform,
                    "content_type": content_type
                },
                "quality_metrics": {
                    "seo_score": optimized_content.seo_score,
                    "engagement_potential": optimized_content.engagement_potential,
                    "readability_score": optimized_content.readability_score,
                    "platform_optimized": optimized_content.platform_optimized
                },
                "recommendations": await self._generate_improvement_recommendations(
                    optimized_content, quality_metrics
                ),
                "status": "completed",
                "timestamp": datetime.now().isoformat()
            }
            
            logger.info(f"DraftingAgent –∑–∞–≤–µ—Ä—à–∏–ª –∑–∞–¥–∞—á—É {task.id}")
            return result
            
        except Exception as e:
            logger.error(f"–û—à–∏–±–∫–∞ –≤ DraftingAgent: {e}")
            raise
    
    async def _generate_content(self, brief_data: Dict[str, Any], 
                              platform: str, content_type: str,
                              strategy_data: Dict[str, Any]) -> GeneratedContent:
        """–ì–µ–Ω–µ—Ä–∏—Ä—É–µ—Ç –∫–æ–Ω—Ç–µ–Ω—Ç –Ω–∞ –æ—Å–Ω–æ–≤–µ –±—Ä–∏—Ñ–∞"""
        
        # –ü–æ–ª—É—á–∞–µ–º —à–∞–±–ª–æ–Ω –¥–ª—è –ø–ª–∞—Ç—Ñ–æ—Ä–º—ã
        template_key = f"{platform}_{content_type}"
        template = self.content_templates.get(template_key, 
                                            self.content_templates["telegram_post"])
        
        # –°–æ–∑–¥–∞–µ–º –∫–æ–Ω—Ç–µ–Ω—Ç-–ø–∏—Å
        content_piece = ContentPiece(
            brief_id=brief_data.get("brief_id", ""),
            content_type=ContentType(content_type),
            platform=Platform(platform),
            title=brief_data.get("title", ""),
            status=ContentStatus.DRAFT,
            created_by_agent=self.agent_id
        )
        
        # –ì–µ–Ω–µ—Ä–∏—Ä—É–µ–º —Ç–µ–∫—Å—Ç –ø–æ —à–∞–±–ª–æ–Ω—É
        text_parts = []
        
        # Hook (–∑–∞—Ü–µ–ø–∫–∞)
        if "hook" in template.required_elements:
            hook = await self._generate_hook(brief_data, strategy_data, platform)
            text_parts.append(hook)
        
        # –û—Å–Ω–æ–≤–Ω–æ–π –∫–æ–Ω—Ç–µ–Ω—Ç
        if "main_content" in template.required_elements:
            main_content = await self._generate_main_content(brief_data, strategy_data, platform)
            text_parts.append(main_content)
        
        # Call to action (–≤ –æ—Ç–¥–µ–ª—å–Ω–æ–µ –ø–æ–ª–µ, –Ω–µ –≤ —Ç–µ–∫—Å—Ç)
        if "call_to_action" in template.optional_elements:
            cta = await self._generate_call_to_action(brief_data, platform)
            content_piece.call_to_action = cta
        
        # –û–±—ä–µ–¥–∏–Ω—è–µ–º —á–∞—Å—Ç–∏ —Å –¥–≤–æ–π–Ω—ã–º–∏ –ø–µ—Ä–µ–Ω–æ—Å–∞–º–∏ —Å—Ç—Ä–æ–∫ (–¥–ª—è —á–∏—Ç–∞–µ–º–æ—Å—Ç–∏)
        content_piece.text = "\n\n".join([part.strip() for part in text_parts if part.strip()])
        
        # –ü–æ—Å—Ç-–æ–±—Ä–∞–±–æ—Ç–∫–∞: —É–±–µ–∂–¥–∞–µ–º—Å—è —á—Ç–æ —Ç–µ–∫—Å—Ç —Ä–∞–∑–±–∏—Ç –Ω–∞ –∞–±–∑–∞—Ü—ã
        # –ï—Å–ª–∏ —Ç–µ–∫—Å—Ç —Å–ª–∏—à–∫–æ–º –¥–ª–∏–Ω–Ω—ã–π –±–µ–∑ –ø–µ—Ä–µ–Ω–æ—Å–æ–≤, –ø—ã—Ç–∞–µ–º—Å—è —Ä–∞–∑–±–∏—Ç—å –Ω–∞ –∞–±–∑–∞—Ü—ã
        if content_piece.text and '\n\n' not in content_piece.text and len(content_piece.text) > 300:
            # –ü—ã—Ç–∞–µ–º—Å—è –Ω–∞–π—Ç–∏ –º–µ—Å—Ç–∞ –¥–ª—è —Ä–∞–∑–±–∏–≤–∫–∏ –ø–æ –ø—Ä–µ–¥–ª–æ–∂–µ–Ω–∏—è–º
            sentences = [s.strip() + '.' for s in content_piece.text.replace('.', '|SPLIT|').split('|SPLIT|') if s.strip()]
            if len(sentences) > 4:
                # –ì—Ä—É–ø–ø–∏—Ä—É–µ–º –ø–æ 2-3 –ø—Ä–µ–¥–ª–æ–∂–µ–Ω–∏—è –≤ –∞–±–∑–∞—Ü
                paragraphs = []
                current_paragraph = []
                for sentence in sentences:
                    if sentence.strip() and sentence.strip() != '.':
                        current_paragraph.append(sentence.strip())
                        if len(current_paragraph) >= 3:  # 3 –ø—Ä–µ–¥–ª–æ–∂–µ–Ω–∏—è –≤ –∞–±–∑–∞—Ü
                            paragraphs.append(' '.join(current_paragraph))
                            current_paragraph = []
                if current_paragraph:
                    paragraphs.append(' '.join(current_paragraph))
                if len(paragraphs) > 1:
                    content_piece.text = "\n\n".join(paragraphs)
        
        # –ì–µ–Ω–µ—Ä–∏—Ä—É–µ–º —Ö–µ—à—Ç–µ–≥–∏ (–≤—Å–µ–≥–¥–∞ –¥–ª—è Telegram)
        if "hashtags" in template.optional_elements or platform == "telegram":
            hashtags = await self._generate_hashtags(brief_data, platform)
            # –¢–∞–∫–∂–µ –¥–æ–±–∞–≤–ª—è–µ–º —Ö–µ—à—Ç–µ–≥–∏ –∏–∑ –∫–ª—é—á–µ–≤—ã—Ö —Å–ª–æ–≤ –ø–æ–ª—å–∑–æ–≤–∞—Ç–µ–ª—è –µ—Å–ª–∏ —É–∫–∞–∑–∞–Ω—ã
            user_keywords = brief_data.get("keywords", [])
            if user_keywords:
                # –î–æ–±–∞–≤–ª—è–µ–º —Ö–µ—à—Ç–µ–≥–∏ –∏–∑ –∫–ª—é—á–µ–≤—ã—Ö —Å–ª–æ–≤
                for keyword in user_keywords[:5]:
                    # –û—á–∏—â–∞–µ–º –æ—Ç # –∏ –ø—Ä–æ–±–µ–ª–æ–≤, –¥–µ–ª–∞–µ–º —Ö–µ—à—Ç–µ–≥
                    clean_keyword = keyword.replace('#', '').strip()
                    if clean_keyword:
                        hashtag = f"#{clean_keyword.replace(' ', '_').lower()}"
                        if hashtag not in hashtags:
                            hashtags.append(hashtag)
            content_piece.hashtags = hashtags[:10]  # –ú–∞–∫—Å–∏–º—É–º 10 —Ö–µ—à—Ç–µ–≥–æ–≤
        
        # –û–≥—Ä–∞–Ω–∏—á–∏–≤–∞–µ–º –¥–ª–∏–Ω—É
        if len(content_piece.text) > template.max_length:
            content_piece.text = await self._truncate_content(
                content_piece.text, template.max_length
            )
        
        return GeneratedContent(
            content_piece=content_piece,
            platform_optimized=False,  # –ë—É–¥–µ—Ç –æ–ø—Ç–∏–º–∏–∑–∏—Ä–æ–≤–∞–Ω–æ –ø–æ–∑–∂–µ
            seo_score=0.0,  # –ë—É–¥–µ—Ç —Ä–∞—Å—Å—á–∏—Ç–∞–Ω–æ –ø–æ–∑–∂–µ
            engagement_potential=0.0,  # –ë—É–¥–µ—Ç —Ä–∞—Å—Å—á–∏—Ç–∞–Ω–æ –ø–æ–∑–∂–µ
            readability_score=0.0  # –ë—É–¥–µ—Ç —Ä–∞—Å—Å—á–∏—Ç–∞–Ω–æ –ø–æ–∑–∂–µ
        )
    
    async def _generate_hook(self, brief_data: Dict[str, Any], 
                           strategy_data: Dict[str, Any], platform: str) -> str:
        """–ì–µ–Ω–µ—Ä–∏—Ä—É–µ—Ç –∑–∞—Ü–µ–ø–∫—É –¥–ª—è –∫–æ–Ω—Ç–µ–Ω—Ç–∞"""
        tone = brief_data.get("tone", "professional")
        target_audience = brief_data.get("target_audience", "")
        keywords = brief_data.get("keywords", [])
        
        # –ü–æ–ª—É—á–∞–µ–º –≥–∞–π–¥ –ø–æ —Ç–æ–Ω—É
        tone_guide = self.tone_guides.get(tone, self.tone_guides["professional"])
        
        # –ù–ï –∏—Å–ø–æ–ª—å–∑—É–µ–º —à–∞–±–ª–æ–Ω–Ω—ã–µ –∑–∞—Ü–µ–ø–∫–∏ - –æ–Ω–∏ –∑–≤—É—á–∞—Ç –∫–∞–∫ –ò–ò
        # –ó–∞—Ü–µ–ø–∫–∞ –±—É–¥–µ—Ç —Å–≥–µ–Ω–µ—Ä–∏—Ä–æ–≤–∞–Ω–∞ –≤ –æ—Å–Ω–æ–≤–Ω–æ–º –∫–æ–Ω—Ç–µ–Ω—Ç–µ, –∞ –Ω–µ –æ—Ç–¥–µ–ª—å–Ω–æ
        # –ü—Ä–æ—Å—Ç–æ –∏—Å–ø–æ–ª—å–∑—É–µ–º –∑–∞–≥–æ–ª–æ–≤–æ–∫ –∏–ª–∏ –ø–µ—Ä–≤—É—é –º—ã—Å–ª—å –∏–∑ –æ–ø–∏—Å–∞–Ω–∏—è –±–µ–∑ —ç–º–æ–¥–∑–∏
        title = brief_data.get("title", "")
        description = brief_data.get("description", "")
        
        # –ò—Å–ø–æ–ª—å–∑—É–µ–º –∑–∞–≥–æ–ª–æ–≤–æ–∫ –∫–∞–∫ –∑–∞—Ü–µ–ø–∫—É –µ—Å–ª–∏ –æ–Ω –µ—Å—Ç—å
        if title:
            hook = title
        elif description:
            # –ë–µ—Ä–µ–º –ø–µ—Ä–≤—É—é –æ—Å–º—ã—Å–ª–µ–Ω–Ω—É—é —Ñ—Ä–∞–∑—É –∏–∑ –æ–ø–∏—Å–∞–Ω–∏—è (–ø—Ä–æ–ø—É—Å–∫–∞–µ–º —Ç–µ—Ö–Ω–∏—á–µ—Å–∫–∏–µ –≤—Å—Ç—É–ø–ª–µ–Ω–∏—è)
            sentences = description.split('.')
            for sentence in sentences:
                sentence = sentence.strip()
                if len(sentence) > 20 and not any(phrase in sentence.lower() for phrase in ['—ç—Ç–æ –∫–æ–º–ø–ª–µ–∫—Å–Ω–∞—è', '–≤–∫–ª—é—á–∞–µ—Ç', '–∏–º–µ–µ—Ç', '—Å–æ—Å—Ç–æ–∏—Ç', '—ç—Ç–æ –∫–æ–º–ø–ª–µ–∫—Å']):
                    hook = sentence
                    break
            else:
                # –ï—Å–ª–∏ –Ω–∏—á–µ–≥–æ –Ω–µ –Ω–∞—à–ª–∏, –±–µ—Ä–µ–º –ø–µ—Ä–≤–æ–µ –ø—Ä–µ–¥–ª–æ–∂–µ–Ω–∏–µ
                hook = sentences[0].strip() if sentences else description[:80]
            
            if len(hook) > 100:
                hook = hook[:100] + "..."
        else:
            # –ú–∏–Ω–∏–º–∞–ª—å–Ω–∞—è fallback –∑–∞—Ü–µ–ø–∫–∞ –±–µ–∑ —à–∞–±–ª–æ–Ω–æ–≤
            hook = f"–û {keywords[0] if keywords else '–≤–∞–∂–Ω–æ–º'}."
        
        # –ù–ï –¥–æ–±–∞–≤–ª—è–µ–º —ç–º–æ–¥–∑–∏ –∞–≤—Ç–æ–º–∞—Ç–∏—á–µ—Å–∫–∏ - –∑–∞—Ü–µ–ø–∫–∞ –¥–æ–ª–∂–Ω–∞ –±—ã—Ç—å –±–µ–∑ —ç–º–æ–¥–∑–∏
        return hook
    
    async def _generate_main_content(self, brief_data: Dict[str, Any], 
                                   strategy_data: Dict[str, Any], platform: str) -> str:
        """–ì–µ–Ω–µ—Ä–∏—Ä—É–µ—Ç –æ—Å–Ω–æ–≤–Ω–æ–π –∫–æ–Ω—Ç–µ–Ω—Ç —á–µ—Ä–µ–∑ AI –∏–ª–∏ fallback –Ω–∞ —à–∞–±–ª–æ–Ω—ã"""
        try:
            # –ü—ã—Ç–∞–µ–º—Å—è –∏—Å–ø–æ–ª—å–∑–æ–≤–∞—Ç—å AI –≥–µ–Ω–µ—Ä–∞—Ü–∏—é
            ai_content = await self._generate_content_with_ai(brief_data, strategy_data, platform)
            if ai_content:
                logger.info(f"–û—Å–Ω–æ–≤–Ω–æ–π –∫–æ–Ω—Ç–µ–Ω—Ç —Å–≥–µ–Ω–µ—Ä–∏—Ä–æ–≤–∞–Ω —á–µ—Ä–µ–∑ AI –¥–ª—è {platform}")
                return ai_content
        except Exception as e:
            logger.warning(f"–û—à–∏–±–∫–∞ AI –≥–µ–Ω–µ—Ä–∞—Ü–∏–∏, –∏—Å–ø–æ–ª—å–∑—É–µ–º fallback: {e}")
        
        # Fallback –Ω–∞ —à–∞–±–ª–æ–Ω–Ω—É—é –≥–µ–Ω–µ—Ä–∞—Ü–∏—é
        return await self._generate_main_content_fallback(brief_data, strategy_data, platform)
    
    async def _generate_content_with_ai(self, brief_data: Dict[str, Any], 
                                      strategy_data: Dict[str, Any], platform: str) -> Optional[str]:
        """–ì–µ–Ω–µ—Ä–∏—Ä—É–µ—Ç –∫–æ–Ω—Ç–µ–Ω—Ç —á–µ—Ä–µ–∑ AI –º–æ–¥–µ–ª–∏"""
        try:
            import os
            import openai
            
            # –ü—Ä–æ–≤–µ—Ä—è–µ–º –Ω–∞–ª–∏—á–∏–µ OpenAI API –∫–ª—é—á–∞
            api_key = os.getenv('OPENAI_API_KEY')
            if not api_key:
                logger.warning("OPENAI_API_KEY –Ω–µ —É—Å—Ç–∞–Ω–æ–≤–ª–µ–Ω, –∏—Å–ø–æ–ª—å–∑—É–µ–º fallback")
                return None
            
            # –ü–æ–ª—É—á–∞–µ–º –ø—Ä–æ–º–ø—Ç –¥–ª—è –ø–ª–∞—Ç—Ñ–æ—Ä–º—ã
            prompt_key = f"{platform}_post"
            prompt = self.ai_prompts.get(prompt_key)
            
            if not prompt:
                logger.warning(f"–ü—Ä–æ–º–ø—Ç –¥–ª—è {platform} –Ω–µ –Ω–∞–π–¥–µ–Ω")
                return None
            
            # –ü–æ–¥–≥–æ—Ç–∞–≤–ª–∏–≤–∞–µ–º –¥–∞–Ω–Ω—ã–µ –¥–ª—è –ø—Ä–æ–º–ø—Ç–∞
            title = brief_data.get("title", "")
            description = brief_data.get("description", "")
            target_audience = brief_data.get("target_audience", "–ø–æ–ª—å–∑–æ–≤–∞—Ç–µ–ª–∏")
            tone = brief_data.get("tone", "professional")
            keywords = ", ".join(brief_data.get("keywords", []))
            business_goals = brief_data.get("business_goals", [])
            
            # –§–æ—Ä–º–∏—Ä—É–µ–º —Ç–µ–º—É: –∏—Å–ø–æ–ª—å–∑—É–µ–º title –µ—Å–ª–∏ –µ—Å—Ç—å, –∏–Ω–∞—á–µ description
            topic = title if title else description[:200] if description else "–∫–æ–Ω—Ç–µ–Ω—Ç"
            
            # –§–æ—Ä–º–∏—Ä—É–µ–º —Ñ–∏–Ω–∞–ª—å–Ω—ã–π –ø—Ä–æ–º–ø—Ç —Å –ø–æ–ª–Ω—ã–º –æ–ø–∏—Å–∞–Ω–∏–µ–º
            # –ï—Å–ª–∏ description –¥–ª–∏–Ω–Ω—ã–π, –∏—Å–ø–æ–ª—å–∑—É–µ–º –µ–≥–æ –∫–∞–∫ –æ—Å–Ω–æ–≤—É –¥–ª—è –≥–µ–Ω–µ—Ä–∞—Ü–∏–∏
            full_description = description if description else title
            
            final_prompt = prompt.prompt_template.format(
                topic=topic,
                target_audience=target_audience,
                tone=tone,
                keywords=keywords
            )
            
            # –î–æ–±–∞–≤–ª—è–µ–º –ø–æ–ª–Ω–æ–µ –æ–ø–∏—Å–∞–Ω–∏–µ –≤ –ø—Ä–æ–º–ø—Ç –µ—Å–ª–∏ –æ–Ω–æ –µ—Å—Ç—å
            if description and len(description) > 50:
                # –û–±—Ä–µ–∑–∞–µ–º –æ–ø–∏—Å–∞–Ω–∏–µ –µ—Å–ª–∏ –æ–Ω–æ —Å–ª–∏—à–∫–æ–º –¥–ª–∏–Ω–Ω–æ–µ (—á—Ç–æ–±—ã –Ω–µ –ø—Ä–µ–≤—ã—Å–∏—Ç—å –ª–∏–º–∏—Ç—ã —Ç–æ–∫–µ–Ω–æ–≤)
                # –ù–æ –æ—Å—Ç–∞–≤–ª—è–µ–º –¥–æ—Å—Ç–∞—Ç–æ—á–Ω–æ –¥–ª—è –ø–æ–ª–Ω–æ—Ü–µ–Ω–Ω–æ–≥–æ –∫–æ–Ω—Ç–µ–Ω—Ç–∞
                max_desc_length = 800  # –ü—Ä–∏–º–µ—Ä–Ω–æ 600 —Ç–æ–∫–µ–Ω–æ–≤ –Ω–∞ –æ–ø–∏—Å–∞–Ω–∏–µ
                description_to_use = description[:max_desc_length] if len(description) > max_desc_length else description
                final_prompt += f"\n\n–î–µ—Ç–∞–ª—å–Ω–æ–µ –æ–ø–∏—Å–∞–Ω–∏–µ —Ç–µ–º—ã (–û–ë–Ø–ó–ê–¢–ï–õ–¨–ù–û –∏—Å–ø–æ–ª—å–∑—É–π —ç—Ç—É –∏–Ω—Ñ–æ—Ä–º–∞—Ü–∏—é –¥–ª—è —Å–æ–∑–¥–∞–Ω–∏—è –∫–æ–Ω—Ç–µ–Ω—Ç–∞):\n{description_to_use}"
                if len(description) > max_desc_length:
                    final_prompt += f"\n\n(–æ–ø–∏—Å–∞–Ω–∏–µ –æ–±—Ä–µ–∑–∞–Ω–æ, –Ω–æ –∏—Å–ø–æ–ª—å–∑—É–π –∫–ª—é—á–µ–≤—ã–µ –º–æ–º–µ–Ω—Ç—ã –∏–∑ –Ω–∞—á–∞–ª–∞)"
                
                # –î–æ–±–∞–≤–ª—è–µ–º –≤–∞–∂–Ω–æ–µ –Ω–∞–ø–æ–º–∏–Ω–∞–Ω–∏–µ –æ–± –∏—Å–ø–æ–ª—å–∑–æ–≤–∞–Ω–∏–∏ –∫–æ–Ω—Ç–µ–∫—Å—Ç–∞ —Å—Ñ–µ—Ä—ã
                final_prompt += f"\n\n–í–ê–ñ–ù–û: –û–ø–∏—Å–∞–Ω–∏–µ —Å–æ–¥–µ—Ä–∂–∏—Ç –∫–æ–Ω—Ç–µ–∫—Å—Ç —Ç–≤–æ–µ–π —Å—Ñ–µ—Ä—ã –¥–µ—è—Ç–µ–ª—å–Ω–æ—Å—Ç–∏. –ò—Å–ø–æ–ª—å–∑—É–π —Ç–µ—Ä–º–∏–Ω–æ–ª–æ–≥–∏—é, –ø—Ä–∏–º–µ—Ä—ã –∏ —Å—Ç–∏–ª—å, —Ö–∞—Ä–∞–∫—Ç–µ—Ä–Ω—ã–µ –¥–ª—è —ç—Ç–æ–π –æ–±–ª–∞—Å—Ç–∏. –ù–æ –ø–∏—à–∏ –µ—Å—Ç–µ—Å—Ç–≤–µ–Ω–Ω–æ, –∫–∞–∫ —ç–∫—Å–ø–µ—Ä—Ç, –∫–æ—Ç–æ—Ä—ã–π –¥–µ–ª–∏—Ç—Å—è –∑–Ω–∞–Ω–∏—è–º–∏, –∞ –Ω–µ –∫–∞–∫ –º–∞—Ä–∫–µ—Ç–æ–ª–æ–≥ –∏–ª–∏ –ò–ò-–∞—Å—Å–∏—Å—Ç–µ–Ω—Ç."
            
            # –î–æ–±–∞–≤–ª—è–µ–º –±–∏–∑–Ω–µ—Å-—Ü–µ–ª–∏ –µ—Å–ª–∏ –µ—Å—Ç—å (–Ω–æ –ù–ï –¥–æ–±–∞–≤–ª—è–µ–º –∏—Ö –≤ —Ç–µ–∫—Å—Ç –ø–æ—Å—Ç–∞!)
            if business_goals:
                goals_text = ", ".join(business_goals)
                final_prompt += f"\n\n–ë–∏–∑–Ω–µ—Å-—Ü–µ–ª–∏ (–¥–ª—è –∫–æ–Ω—Ç–µ–∫—Å—Ç–∞, –ù–ï –≤–∫–ª—é—á–∞–π –∏—Ö –≤ —Ç–µ–∫—Å—Ç –ø–æ—Å—Ç–∞): {goals_text}"
            
            # –í—ã–∑—ã–≤–∞–µ–º OpenAI API –Ω–∞–ø—Ä—è–º—É—é
            try:
                client = openai.OpenAI(api_key=api_key)
                response = client.chat.completions.create(
                    model="gpt-5-mini",  # –û–±–Ω–æ–≤–ª–µ–Ω–æ –Ω–∞ GPT-5-mini –¥–ª—è –ª—É—á—à–µ–≥–æ –∫–∞—á–µ—Å—Ç–≤–∞ –ø—Ä–∏ —Ç–æ–π –∂–µ —Ü–µ–Ω–µ
                    messages=[
                        {"role": "system", "content": prompt.system_message},
                        {"role": "user", "content": final_prompt}
                    ],
                    max_tokens=prompt.max_tokens,
                    temperature=prompt.temperature,
                    n=1
                )
                
                if response.choices and len(response.choices) > 0:
                    generated_text = response.choices[0].message.content.strip()
                    
                    # –õ–æ–≥–∏—Ä—É–µ–º –∏—Å–ø–æ–ª—å–∑–æ–≤–∞–Ω–∏–µ —Ç–æ–∫–µ–Ω–æ–≤ –µ—Å–ª–∏ –¥–æ—Å—Ç—É–ø–Ω–æ
                    if response.usage:
                        logger.info(f"‚úÖ –ö–æ–Ω—Ç–µ–Ω—Ç —Å–≥–µ–Ω–µ—Ä–∏—Ä–æ–≤–∞–Ω —á–µ—Ä–µ–∑ GPT-5-mini –¥–ª—è {platform}: "
                                  f"prompt={response.usage.prompt_tokens}, "
                                  f"completion={response.usage.completion_tokens}, "
                                  f"total={response.usage.total_tokens}")
                    
                    return generated_text
                
            except openai.APIError as e:
                logger.error(f"OpenAI API Error: {e}")
                return None
            except openai.RateLimitError as e:
                logger.error(f"OpenAI Rate Limit: {e}")
                return None
            except Exception as e:
                logger.error(f"OpenAI Error: {e}")
                return None
            
            # Fallback –Ω–∞ MCP –∏–Ω—Ç–µ–≥—Ä–∞—Ü–∏–∏ –µ—Å–ª–∏ OpenAI –Ω–µ —Å—Ä–∞–±–æ—Ç–∞–ª
            if self.huggingface_mcp is not None:
                result = await self.huggingface_mcp.execute_with_retry(
                    'generate_text',
                    prompt=final_prompt,
                    max_tokens=prompt.max_tokens,
                    temperature=prompt.temperature
                )
                
                if result.success and result.data:
                    return result.data.get('generated_text', '')
            
            if self.openai_mcp is not None:
                result = await self.openai_mcp.execute_with_retry(
                    'generate_content',
                    prompt=final_prompt,
                    max_tokens=prompt.max_tokens,
                    temperature=prompt.temperature
                )
                
                if result.success and result.data:
                    return result.data.get('content', '')
            
            return None
            
        except Exception as e:
            logger.error(f"–û—à–∏–±–∫–∞ AI –≥–µ–Ω–µ—Ä–∞—Ü–∏–∏ –∫–æ–Ω—Ç–µ–Ω—Ç–∞: {e}")
            return None
    
    async def _generate_main_content_fallback(self, brief_data: Dict[str, Any], 
                                            strategy_data: Dict[str, Any], platform: str) -> str:
        """Fallback –º–µ—Ç–æ–¥ –¥–ª—è –≥–µ–Ω–µ—Ä–∞—Ü–∏–∏ –æ—Å–Ω–æ–≤–Ω–æ–≥–æ –∫–æ–Ω—Ç–µ–Ω—Ç–∞ (—à–∞–±–ª–æ–Ω–Ω–∞—è –ª–æ–≥–∏–∫–∞)"""
        description = brief_data.get("description", "")
        target_audience = brief_data.get("target_audience", "")
        tone = brief_data.get("tone", "professional")
        keywords = brief_data.get("keywords", [])
        
        # –ü–æ–ª—É—á–∞–µ–º –≥–∞–π–¥ –ø–æ —Ç–æ–Ω—É
        tone_guide = self.tone_guides.get(tone, self.tone_guides["professional"])
        
        # –°–æ–∑–¥–∞–µ–º –æ—Å–Ω–æ–≤–Ω–æ–π –∫–æ–Ω—Ç–µ–Ω—Ç (fallback - —Ç–æ–ª—å–∫–æ –µ—Å–ª–∏ AI –Ω–µ —Å—Ä–∞–±–æ—Ç–∞–ª)
        # –ò—Å–ø–æ–ª—å–∑—É–µ–º –æ–ø–∏—Å–∞–Ω–∏–µ –Ω–∞–ø—Ä—è–º—É—é, —Ä–∞–∑–±–∏–≤–∞–µ–º –Ω–∞ –∞–±–∑–∞—Ü—ã
        content_parts = []
        
        # –ë–µ—Ä–µ–º –æ–ø–∏—Å–∞–Ω–∏–µ –∏ —Ä–∞–∑–±–∏–≤–∞–µ–º –Ω–∞ –∞–±–∑–∞—Ü—ã
        if description:
            # –†–∞–∑–±–∏–≤–∞–µ–º –æ–ø–∏—Å–∞–Ω–∏–µ –ø–æ –ø—Ä–µ–¥–ª–æ–∂–µ–Ω–∏—è–º
            sentences = [s.strip() + '.' for s in description.split('.') if s.strip()]
            
            # –ì—Ä—É–ø–ø–∏—Ä—É–µ–º –ø–æ 2-3 –ø—Ä–µ–¥–ª–æ–∂–µ–Ω–∏—è –≤ –∞–±–∑–∞—Ü
            paragraphs = []
            current_paragraph = []
            for sentence in sentences:
                if sentence.strip() and sentence.strip() != '.':
                    current_paragraph.append(sentence.strip())
                    if len(current_paragraph) >= 3:  # 3 –ø—Ä–µ–¥–ª–æ–∂–µ–Ω–∏—è –≤ –∞–±–∑–∞—Ü
                        paragraphs.append(' '.join(current_paragraph))
                        current_paragraph = []
            
            if current_paragraph:
                paragraphs.append(' '.join(current_paragraph))
            
            # –î–æ–±–∞–≤–ª—è–µ–º –∞–±–∑–∞—Ü—ã —Å –ø–µ—Ä–µ–Ω–æ—Å–∞–º–∏ —Å—Ç—Ä–æ–∫
            content_parts.extend(paragraphs)
        else:
            # –ú–∏–Ω–∏–º–∞–ª—å–Ω—ã–π fallback
            content_parts.append(f"{title or '–†–∞—Å—Å–∫–∞–∑—ã–≤–∞—é –æ –≤–∞–∂–Ω–æ–π —Ç–µ–º–µ'}.")
        
        # –ù–ï –¥–æ–±–∞–≤–ª—è–µ–º —à–∞–±–ª–æ–Ω–Ω—ã–µ —Ñ—Ä–∞–∑—ã, –±–∏–∑–Ω–µ—Å-—Ü–µ–ª–∏ –∏–ª–∏ –º–µ—Ç–∞–¥–∞–Ω–Ω—ã–µ
        
        return "\n\n".join(content_parts)
    
    async def _generate_call_to_action(self, brief_data: Dict[str, Any], platform: str) -> str:
        """–ì–µ–Ω–µ—Ä–∏—Ä—É–µ—Ç –ø—Ä–∏–∑—ã–≤ –∫ –¥–µ–π—Å—Ç–≤–∏—é –∏–∑ –º–∞—Å—Å–∏–≤–∞ —ç–ª–µ–º–µ–Ω—Ç–æ–≤"""
        cta_items = brief_data.get("call_to_action", [])
        platform_guidelines = self.platform_guidelines.get(platform, {})
        
        # –ï—Å–ª–∏ –Ω–µ—Ç CTA —ç–ª–µ–º–µ–Ω—Ç–æ–≤, –≥–µ–Ω–µ—Ä–∏—Ä—É–µ–º –¥–µ—Ñ–æ–ª—Ç–Ω—ã–π
        if not cta_items:
            cta_style = platform_guidelines.get("call_to_action", "direct")
            
            if cta_style == "direct":
                return "–ü–æ–¥–ø–∏—Å—ã–≤–∞–π—Ç–µ—Å—å –Ω–∞ –Ω–∞—à –∫–∞–Ω–∞–ª!"
            elif cta_style == "engaging":
                return "–ß—Ç–æ –¥—É–º–∞–µ—Ç–µ? –ü–∏—à–∏—Ç–µ –≤ –∫–æ–º–º–µ–Ω—Ç–∞—Ä–∏—è—Ö!"
            elif cta_style == "soft":
                return "–ü–æ–Ω—Ä–∞–≤–∏–ª–æ—Å—å? –°–æ—Ö—Ä–∞–Ω–∏—Ç–µ –ø–æ—Å—Ç!"
            else:
                return "–£–∑–Ω–∞—Ç—å –±–æ–ª—å—à–µ"
        
        # –ú–∞–ø–ø–∏–Ω–≥ –∞–Ω–≥–ª–∏–π—Å–∫–∏—Ö CTA ID –Ω–∞ —Ä—É—Å—Å–∫–∏–µ —Ç–µ–∫—Å—Ç—ã
        cta_translations = {
            "purchase": "–£–∑–Ω–∞—Ç—å —Å—Ç–æ–∏–º–æ—Å—Ç—å –∏ –∑–∞–∫–∞–∑–∞—Ç—å",
            "consultation": "–ü–æ–ª—É—á–∏—Ç—å –∫–æ–Ω—Å—É–ª—å—Ç–∞—Ü–∏—é",
            "visual": "–ü–æ—Å–º–æ—Ç—Ä–µ—Ç—å –ø—Ä–∏–º–µ—Ä—ã —Ä–∞–±–æ—Ç",
            "website": "–ü–µ—Ä–µ–π—Ç–∏ –Ω–∞ —Å–∞–π—Ç",
            "subscribe": "–ü–æ–¥–ø–∏—Å–∞—Ç—å—Å—è –Ω–∞ –∫–∞–Ω–∞–ª",
            "contact": "–°–≤—è–∑–∞—Ç—å—Å—è —Å –Ω–∞–º–∏",
            "order": "–û—Ñ–æ—Ä–º–∏—Ç—å –∑–∞–∫–∞–∑"
        }
        
        # –û–±—Ä–∞–±–∞—Ç—ã–≤–∞–µ–º –º–∞—Å—Å–∏–≤ CTA —ç–ª–µ–º–µ–Ω—Ç–æ–≤
        # –†–∞–∑–¥–µ–ª—è–µ–º –Ω–∞ —Ç–µ–∫—Å—Ç –∏ —Å—Å—ã–ª–∫–∏
        texts = []
        links = []
        
        for item in cta_items:
            if item.startswith('http://') or item.startswith('https://'):
                links.append(item)
            else:
                # –ü–µ—Ä–µ–≤–æ–¥–∏–º –∞–Ω–≥–ª–∏–π—Å–∫–∏–µ ID –Ω–∞ —Ä—É—Å—Å–∫–∏–π
                translated = cta_translations.get(item.lower(), item)
                texts.append(translated)
        
        # –§–æ—Ä–º–∏—Ä—É–µ–º –∏—Ç–æ–≥–æ–≤—ã–π CTA –≤ –∑–∞–≤–∏—Å–∏–º–æ—Å—Ç–∏ –æ—Ç –ø–ª–∞—Ç—Ñ–æ—Ä–º—ã
        if platform == "instagram":
            # Instagram - —Ç–æ–ª—å–∫–æ —Ç–µ–∫—Å—Ç, —Å—Å—ã–ª–∫–∞ –≤ bio
            if texts:
                return texts[0] + " üîó –°—Å—ã–ª–∫–∞ –≤ bio"
            return "–ü–æ–¥—Ä–æ–±–Ω–µ–µ –≤ bio üîó"
        
        elif platform == "telegram":
            # Telegram - –º–æ–∂–Ω–æ –∏—Å–ø–æ–ª—å–∑–æ–≤–∞—Ç—å –≤—Å–µ —ç–ª–µ–º–µ–Ω—Ç—ã
            result_parts = []
            for i, text in enumerate(texts):
                result_parts.append(text)
                # –î–æ–±–∞–≤–ª—è–µ–º —Å—Å—ã–ª–∫—É –ø–æ—Å–ª–µ —Ç–µ–∫—Å—Ç–∞ –µ—Å–ª–∏ –µ—Å—Ç—å
                if i < len(links):
                    result_parts.append(links[i])
            return "\n".join(result_parts) if result_parts else "–ü–æ–¥–ø–∏—Å—ã–≤–∞–π—Ç–µ—Å—å –Ω–∞ –∫–∞–Ω–∞–ª!"
        
        elif platform == "vk":
            # VK - —Ç–µ–∫—Å—Ç + –ø–µ—Ä–≤–∞—è —Å—Å—ã–ª–∫–∞
            result = texts[0] if texts else "–£–∑–Ω–∞—Ç—å –±–æ–ª—å—à–µ"
            if links:
                result += f"\n{links[0]}"
            return result
        
        else:
            # –î–ª—è –æ—Å—Ç–∞–ª—å–Ω—ã—Ö –ø–ª–∞—Ç—Ñ–æ—Ä–º - —Ç–µ–∫—Å—Ç + –ø–µ—Ä–≤–∞—è —Å—Å—ã–ª–∫–∞
            result = " ".join(texts[:2]) if texts else "–£–∑–Ω–∞—Ç—å –±–æ–ª—å—à–µ"
            if links:
                result += f" {links[0]}"
            return result
    
    async def _generate_hashtags(self, brief_data: Dict[str, Any], platform: str) -> List[str]:
        """–ì–µ–Ω–µ—Ä–∏—Ä—É–µ—Ç —Ö–µ—à—Ç–µ–≥–∏"""
        import re
        
        keywords = brief_data.get("keywords", [])
        title = brief_data.get("title", "")
        description = brief_data.get("description", "")
        platform_guidelines = self.platform_guidelines.get(platform, {})
        hashtag_style = platform_guidelines.get("hashtag_style", "minimal")
        
        hashtags = []
        used_words = set()  # –ß—Ç–æ–±—ã –∏–∑–±–µ–∂–∞—Ç—å –¥—É–±–ª–∏–∫–∞—Ç–æ–≤
        
        # –§—É–Ω–∫—Ü–∏—è –¥–ª—è —Å–æ–∑–¥–∞–Ω–∏—è —Ö–µ—à—Ç–µ–≥–∞ –∏–∑ —Å–ª–æ–≤–∞
        def make_hashtag(word: str) -> str:
            # –û—á–∏—â–∞–µ–º –æ—Ç —Å–ø–µ—Ü–∏–∞–ª—å–Ω—ã—Ö —Å–∏–º–≤–æ–ª–æ–≤, –æ—Å—Ç–∞–≤–ª—è–µ–º —Ç–æ–ª—å–∫–æ –±—É–∫–≤—ã –∏ —Ü–∏—Ñ—Ä—ã
            clean_word = re.sub(r'[^–∞-—è–ê-–Øa-zA-Z0-9—ë]', '', word)
            if len(clean_word) > 2:  # –ú–∏–Ω–∏–º–∞–ª—å–Ω–∞—è –¥–ª–∏–Ω–∞ —Ö–µ—à—Ç–µ–≥–∞
                hashtag = f"#{clean_word.lower()}"
                return hashtag
            return None
        
        # –î–æ–±–∞–≤–ª—è–µ–º —Ö–µ—à—Ç–µ–≥–∏ –∏–∑ –∫–ª—é—á–µ–≤—ã—Ö —Å–ª–æ–≤ –ø–æ–ª—å–∑–æ–≤–∞—Ç–µ–ª—è
        for keyword in keywords[:5]:  # –ú–∞–∫—Å–∏–º—É–º 5 —Ö–µ—à—Ç–µ–≥–æ–≤
            if keyword and keyword.strip():
                hashtag = make_hashtag(keyword.strip())
                if hashtag and hashtag not in used_words:
                    hashtags.append(hashtag)
                    used_words.add(hashtag)
        
        # –ï—Å–ª–∏ keywords –Ω–µ—Ç –∏–ª–∏ –º–∞–ª–æ, –∏–∑–≤–ª–µ–∫–∞–µ–º –∫–ª—é—á–µ–≤—ã–µ —Å–ª–æ–≤–∞ –∏–∑ title –∏ description
        if len(hashtags) < 3:
            text_for_extraction = f"{title} {description}"
            # –ò–∑–≤–ª–µ–∫–∞–µ–º —Å—É—â–µ—Å—Ç–≤–∏—Ç–µ–ª—å–Ω—ã–µ –∏ –≤–∞–∂–Ω—ã–µ —Å–ª–æ–≤–∞ (—Å–ª–æ–≤–∞ –¥–ª–∏–Ω–Ω–µ–µ 4 —Å–∏–º–≤–æ–ª–æ–≤)
            words = re.findall(r'\b[–∞-—è–ê-–Øa-zA-Z]{4,}\b', text_for_extraction.lower())
            # –£–±–∏—Ä–∞–µ–º —Å—Ç–æ–ø-—Å–ª–æ–≤–∞ (–ø—Ä–µ–¥–ª–æ–≥–∏, —Å–æ—é–∑—ã, –æ–±—â–∏–µ —Å–ª–æ–≤–∞)
            stop_words = {'—ç—Ç–æ', '–¥–ª—è', '–º–æ–∂–µ—Ç', '–∫–æ—Ç–æ—Ä—ã–π', '–∫–æ—Ç–æ—Ä—ã–µ', '–±—É–¥–µ—Ç', '–æ—á–µ–Ω—å', '–∫–∞–∫', '–∏–ª–∏', '—á—Ç–æ', '—ç—Ç–æ–º', '—ç—Ç–æ–≥–æ', '–∫–æ–≥–¥–∞', '–≥–¥–µ', '—Ç–æ–∂–µ', '—Ç–∞–∫–∂–µ', '–∫–æ—Ç–æ—Ä—ã–µ', '–∫–æ—Ç–æ—Ä—É—é'}
            important_words = [w for w in words if w not in stop_words and len(w) > 3]
            # –ë–µ—Ä–µ–º —É–Ω–∏–∫–∞–ª—å–Ω—ã–µ —Å–ª–æ–≤–∞
            unique_words = list(dict.fromkeys(important_words))[:5]  # –ë–µ—Ä–µ–º –ø–µ—Ä–≤—ã–µ 5 —É–Ω–∏–∫–∞–ª—å–Ω—ã—Ö —Å–ª–æ–≤
            
            for word in unique_words:
                hashtag = make_hashtag(word)
                if hashtag and hashtag not in used_words:
                    hashtags.append(hashtag)
                    used_words.add(hashtag)
                    if len(hashtags) >= 5:
                        break
        
        # –î–æ–±–∞–≤–ª—è–µ–º –ø–ª–∞—Ç—Ñ–æ—Ä–º–æ-—Å–ø–µ—Ü–∏—Ñ–∏—á–Ω—ã–µ —Ö–µ—à—Ç–µ–≥–∏
        platform_hashtags = {
            "telegram": ["#–Ω–æ–≤–æ—Å—Ç–∏", "#–ø–æ–ª–µ–∑–Ω–æ"],
            "vk": ["#–≤–∫–æ–Ω—Ç–∞–∫—Ç–µ", "#–ø–æ–ª–µ–∑–Ω–æ–µ"],
            "instagram": ["#instagood", "#lifestyle", "#motivation"],
            "twitter": ["#trending", "#news"]
        }
        
        if hashtag_style == "extensive":
            hashtags.extend(platform_hashtags.get(platform, [])[:3])
        elif hashtag_style == "moderate":
            hashtags.extend(platform_hashtags.get(platform, [])[:1])
        
        return hashtags[:10]  # –ú–∞–∫—Å–∏–º—É–º 10 —Ö–µ—à—Ç–µ–≥–æ–≤
    
    async def _truncate_content(self, content: str, max_length: int) -> str:
        """–û–±—Ä–µ–∑–∞–µ—Ç –∫–æ–Ω—Ç–µ–Ω—Ç –¥–æ –º–∞–∫—Å–∏–º–∞–ª—å–Ω–æ–π –¥–ª–∏–Ω—ã"""
        if len(content) <= max_length:
            return content
        
        # –û–±—Ä–µ–∑–∞–µ–º –ø–æ –ø—Ä–µ–¥–ª–æ–∂–µ–Ω–∏—è–º
        sentences = content.split('. ')
        truncated = ""
        
        for sentence in sentences:
            if len(truncated + sentence + '. ') <= max_length:
                truncated += sentence + '. '
            else:
                break
        
        return truncated.strip()
    
    async def _optimize_for_platform(self, content: GeneratedContent, platform: str) -> GeneratedContent:
        """–û–ø—Ç–∏–º–∏–∑–∏—Ä—É–µ—Ç –∫–æ–Ω—Ç–µ–Ω—Ç –¥–ª—è –∫–æ–Ω–∫—Ä–µ—Ç–Ω–æ–π –ø–ª–∞—Ç—Ñ–æ—Ä–º—ã"""
        platform_guidelines = self.platform_guidelines.get(platform, {})
        content_piece = content.content_piece
        
        # –û–ø—Ç–∏–º–∏–∑–∏—Ä—É–µ–º —Ç–æ–Ω
        tone = platform_guidelines.get("tone", "casual")
        if tone == "informal":
            content_piece.text = await self._make_informal(content_piece.text)
        elif tone == "inspirational":
            content_piece.text = await self._make_inspirational(content_piece.text)
        
        # –û–ø—Ç–∏–º–∏–∑–∏—Ä—É–µ–º —ç–º–æ–¥–∑–∏
        emoji_usage = platform_guidelines.get("emoji_usage", "moderate")
        if emoji_usage == "frequent":
            content_piece.text = await self._add_emojis(content_piece.text, 3)
        elif emoji_usage == "minimal":
            content_piece.text = await self._remove_emojis(content_piece.text)
        
        # –û–ø—Ç–∏–º–∏–∑–∏—Ä—É–µ–º —Ö–µ—à—Ç–µ–≥–∏
        hashtag_style = platform_guidelines.get("hashtag_style", "minimal")
        if hashtag_style == "minimal":
            content_piece.hashtags = content_piece.hashtags[:3]
        elif hashtag_style == "extensive":
            content_piece.hashtags.extend(["#viral", "#trending"])
        
        content.platform_optimized = True
        return content
    
    async def _make_informal(self, text: str) -> str:
        """–î–µ–ª–∞–µ—Ç —Ç–µ–∫—Å—Ç –±–æ–ª–µ–µ –Ω–µ—Ñ–æ—Ä–º–∞–ª—å–Ω—ã–º"""
        replacements = {
            "–º—ã –ø—Ä–µ–¥–ª–∞–≥–∞–µ–º": "–º—ã –¥–µ–ª–∞–µ–º",
            "–Ω–∞—à–∞ –∫–æ–º–ø–∞–Ω–∏—è": "–º—ã",
            "–ø—Ä–æ—Ñ–µ—Å—Å–∏–æ–Ω–∞–ª—å–Ω—ã–µ": "–∫—Ä—É—Ç—ã–µ",
            "—Ä–µ—à–µ–Ω–∏—è": "—Ñ–∏—à–∫–∏"
        }
        
        for formal, informal in replacements.items():
            text = text.replace(formal, informal)
        
        return text
    
    async def _make_inspirational(self, text: str) -> str:
        """–î–µ–ª–∞–µ—Ç —Ç–µ–∫—Å—Ç –±–æ–ª–µ–µ –≤–¥–æ—Ö–Ω–æ–≤–ª—è—é—â–∏–º"""
        inspirational_words = ["–≤–¥–æ—Ö–Ω–æ–≤–ª—è—é—â–∏–π", "–º–æ—Ç–∏–≤–∏—Ä—É—é—â–∏–π", "–ø—Ä–µ–æ–±—Ä–∞–∂–∞—é—â–∏–π"]
        import random
        
        if "–≤–∞–∂–Ω–æ" in text:
            text = text.replace("–≤–∞–∂–Ω–æ", random.choice(inspirational_words))
        
        return text
    
    async def _add_emojis(self, text: str, count: int) -> str:
        """–î–æ–±–∞–≤–ª—è–µ—Ç —ç–º–æ–¥–∑–∏ –≤ —Ç–µ–∫—Å—Ç"""
        emojis = ["‚ú®", "üöÄ", "üí°", "üéØ", "üî•", "‚≠ê", "üí™", "üéâ"]
        import random
        
        words = text.split()
        for _ in range(min(count, len(words) // 5)):
            if words:
                pos = random.randint(0, len(words) - 1)
                words.insert(pos, random.choice(emojis))
        
        return " ".join(words)
    
    async def _remove_emojis(self, text: str) -> str:
        """–£–¥–∞–ª—è–µ—Ç —ç–º–æ–¥–∑–∏ –∏–∑ —Ç–µ–∫—Å—Ç–∞"""
        emoji_pattern = re.compile("["
                                 u"\U0001F600-\U0001F64F"  # emoticons
                                 u"\U0001F300-\U0001F5FF"  # symbols & pictographs
                                 u"\U0001F680-\U0001F6FF"  # transport & map symbols
                                 u"\U0001F1E0-\U0001F1FF"  # flags (iOS)
                                 "]+", flags=re.UNICODE)
        return emoji_pattern.sub(r'', text)
    
    async def _assess_content_quality(self, content: GeneratedContent) -> Dict[str, float]:
        """–û—Ü–µ–Ω–∏–≤–∞–µ—Ç –∫–∞—á–µ—Å—Ç–≤–æ –∫–æ–Ω—Ç–µ–Ω—Ç–∞"""
        text = content.content_piece.text
        
        # SEO –æ—Ü–µ–Ω–∫–∞
        seo_score = await self._calculate_seo_score(text, content.content_piece.hashtags)
        content.seo_score = seo_score
        
        # –ü–æ—Ç–µ–Ω—Ü–∏–∞–ª –≤–æ–≤–ª–µ—á–µ–Ω–Ω–æ—Å—Ç–∏
        engagement_potential = await self._calculate_engagement_potential(text)
        content.engagement_potential = engagement_potential
        
        # –ß–∏—Ç–∞–µ–º–æ—Å—Ç—å
        readability_score = await self._calculate_readability_score(text)
        content.readability_score = readability_score
        
        return {
            "seo_score": seo_score,
            "engagement_potential": engagement_potential,
            "readability_score": readability_score
        }
    
    async def _calculate_seo_score(self, text: str, hashtags: List[str]) -> float:
        """–†–∞—Å—Å—á–∏—Ç—ã–≤–∞–µ—Ç SEO –æ—Ü–µ–Ω–∫—É"""
        score = 0.0
        
        # –î–ª–∏–Ω–∞ —Ç–µ–∫—Å—Ç–∞
        if 500 <= len(text) <= 1500:
            score += 0.3
        elif 100 <= len(text) < 500:
            score += 0.2
        elif 50 <= len(text) < 100:
            score += 0.1
        
        # –ù–∞–ª–∏—á–∏–µ —Ö–µ—à—Ç–µ–≥–æ–≤
        if hashtags:
            score += 0.2
        
        # –ù–∞–ª–∏—á–∏–µ –∫–ª—é—á–µ–≤—ã—Ö —Å–ª–æ–≤
        keywords = ["—Ä–µ—à–µ–Ω–∏–µ", "–ø—Ä–æ–±–ª–µ–º–∞", "—É—Å–ø–µ—Ö", "—Ä–µ–∑—É–ª—å—Ç–∞—Ç", "—ç—Ñ—Ñ–µ–∫—Ç"]
        for keyword in keywords:
            if keyword in text.lower():
                score += 0.1
        
        return min(score, 1.0)
    
    async def _calculate_engagement_potential(self, text: str) -> float:
        """–†–∞—Å—Å—á–∏—Ç—ã–≤–∞–µ—Ç –ø–æ—Ç–µ–Ω—Ü–∏–∞–ª –≤–æ–≤–ª–µ—á–µ–Ω–Ω–æ—Å—Ç–∏"""
        score = 0.0
        
        # –í–æ–ø—Ä–æ—Å—ã
        if "?" in text:
            score += 0.3
        
        # –≠–º–æ–¥–∑–∏
        emoji_count = len(re.findall(r'[^\w\s]', text))
        if emoji_count > 0:
            score += 0.2
        
        # –ü—Ä–∏–∑—ã–≤—ã –∫ –¥–µ–π—Å—Ç–≤–∏—é
        cta_words = ["–ø–æ–¥–ø–∏—Å—ã–≤–∞–π—Ç–µ—Å—å", "–∫–æ–º–º–µ–Ω—Ç–∏—Ä—É–π—Ç–µ", "–¥–µ–ª–∏—Ç–µ—Å—å", "—Å–æ—Ö—Ä–∞–Ω—è–π—Ç–µ"]
        for word in cta_words:
            if word in text.lower():
                score += 0.2
        
        # –≠–º–æ—Ü–∏–æ–Ω–∞–ª—å–Ω—ã–µ —Å–ª–æ–≤–∞
        emotional_words = ["–∫—Ä—É—Ç–æ", "–æ—Ç–ª–∏—á–Ω–æ", "–ø–æ—Ç—Ä—è—Å–∞—é—â–µ", "–Ω–µ–≤–µ—Ä–æ—è—Ç–Ω–æ"]
        for word in emotional_words:
            if word in text.lower():
                score += 0.1
        
        return min(score, 1.0)
    
    async def _calculate_readability_score(self, text: str) -> float:
        """–†–∞—Å—Å—á–∏—Ç—ã–≤–∞–µ—Ç –æ—Ü–µ–Ω–∫—É —á–∏—Ç–∞–µ–º–æ—Å—Ç–∏"""
        sentences = text.split('.')
        words = text.split()
        
        if not sentences or not words:
            return 0.0
        
        # –°—Ä–µ–¥–Ω—è—è –¥–ª–∏–Ω–∞ –ø—Ä–µ–¥–ª–æ–∂–µ–Ω–∏—è
        avg_sentence_length = len(words) / len(sentences)
        
        # –û—Ü–µ–Ω–∫–∞ —á–∏—Ç–∞–µ–º–æ—Å—Ç–∏ (–ø—Ä–æ—Å—Ç–∞—è —Ñ–æ—Ä–º—É–ª–∞)
        if avg_sentence_length <= 10:
            return 1.0
        elif avg_sentence_length <= 15:
            return 0.8
        elif avg_sentence_length <= 20:
            return 0.6
        else:
            return 0.4
    
    async def _generate_improvement_recommendations(self, content: GeneratedContent, 
                                                  quality_metrics: Dict[str, float]) -> List[str]:
        """–ì–µ–Ω–µ—Ä–∏—Ä—É–µ—Ç —Ä–µ–∫–æ–º–µ–Ω–¥–∞—Ü–∏–∏ –ø–æ —É–ª—É—á—à–µ–Ω–∏—é"""
        recommendations = []
        
        if quality_metrics["seo_score"] < 0.5:
            recommendations.append("–î–æ–±–∞–≤–∏—Ç—å –±–æ–ª—å—à–µ –∫–ª—é—á–µ–≤—ã—Ö —Å–ª–æ–≤ –∏ —Ö–µ—à—Ç–µ–≥–æ–≤")
        
        if quality_metrics["engagement_potential"] < 0.5:
            recommendations.append("–î–æ–±–∞–≤–∏—Ç—å –≤–æ–ø—Ä–æ—Å—ã –∏–ª–∏ –ø—Ä–∏–∑—ã–≤—ã –∫ –¥–µ–π—Å—Ç–≤–∏—é")
        
        if quality_metrics["readability_score"] < 0.6:
            recommendations.append("–£–ø—Ä–æ—Å—Ç–∏—Ç—å –ø—Ä–µ–¥–ª–æ–∂–µ–Ω–∏—è –¥–ª—è –ª—É—á—à–µ–π —á–∏—Ç–∞–µ–º–æ—Å—Ç–∏")
        
        if not content.platform_optimized:
            recommendations.append("–û–ø—Ç–∏–º–∏–∑–∏—Ä–æ–≤–∞—Ç—å –∫–æ–Ω—Ç–µ–Ω—Ç –¥–ª—è —Ü–µ–ª–µ–≤–æ–π –ø–ª–∞—Ç—Ñ–æ—Ä–º—ã")
        
        if not recommendations:
            recommendations.append("–ö–æ–Ω—Ç–µ–Ω—Ç –≥–æ—Ç–æ–≤ –∫ –ø—É–±–ª–∏–∫–∞—Ü–∏–∏!")
        
        return recommendations
